<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Return Level Inferences for Stationary Extreme Value Models — return_level • lax</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Return Level Inferences for Stationary Extreme Value Models — return_level" />
<meta property="og:description" content="Calculates point estimates and confidence intervals for m-observation
return levels for stationary extreme value fitted model objects
returned from alogLik.  Two types of interval may be returned:
(a) intervals based on approximate large-sample normality of the maximum
likelihood estimator for return level, which are symmetric about the point
estimate, and (b) profile likelihood-based intervals based on an (adjusted)
loglikelihood." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lax</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">1.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/lax-vignette.html">An overview of lax</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/paulnorthrop/lax/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Return Level Inferences for Stationary Extreme Value Models</h1>
    <small class="dont-index">Source: <a href='http://github.com/paulnorthrop/lax/blob/master/R/return_level.R'><code>R/return_level.R</code></a></small>
    <div class="hidden name"><code>return_level.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates point estimates and confidence intervals for <code>m</code>-observation
return levels for <strong>stationary</strong> extreme value fitted model objects
returned from <code><a href='alogLik.html'>alogLik</a></code>.  Two types of interval may be returned:
(a) intervals based on approximate large-sample normality of the maximum
likelihood estimator for return level, which are symmetric about the point
estimate, and (b) profile likelihood-based intervals based on an (adjusted)
loglikelihood.</p>
    </div>

    <pre class="usage"><span class='fu'>return_level</span><span class='op'>(</span>
  <span class='va'>x</span>,
  m <span class='op'>=</span> <span class='fl'>100</span>,
  level <span class='op'>=</span> <span class='fl'>0.95</span>,
  npy <span class='op'>=</span> <span class='fl'>1</span>,
  prof <span class='op'>=</span> <span class='cn'>TRUE</span>,
  inc <span class='op'>=</span> <span class='cn'>NULL</span>,
  type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"vertical"</span>, <span class='st'>"cholesky"</span>, <span class='st'>"spectral"</span>, <span class='st'>"none"</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>An object inheriting from class <code>"lax"</code> returned from
<code><a href='alogLik.html'>alogLik</a></code>.</p></td>
    </tr>
    <tr>
      <th>m</th>
      <td><p>A numeric scalar.  The return period, in units of the number
of observations.  See <strong>Details</strong> for information.</p></td>
    </tr>
    <tr>
      <th>level</th>
      <td><p>A numeric scalar in (0, 1).  The confidence level required for
confidence interval for the <code>m</code>-observation return level.</p></td>
    </tr>
    <tr>
      <th>npy</th>
      <td><p>A numeric scalar.  The</p></td>
    </tr>
    <tr>
      <th>prof</th>
      <td><p>A logical scalar.  Should we calculate intervals based on
profile loglikelihood?</p></td>
    </tr>
    <tr>
      <th>inc</th>
      <td><p>A numeric scalar. Only relevant if <code>prof = TRUE</code>. The
increment in return level by which we move upwards and downwards from the
MLE for the return level in the search for the lower and upper confidence
limits.  If this is not supplied then <code>inc</code> is set to one hundredth
of the length of the symmetric confidence interval for return level.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>A character scalar.  The argument <code>type</code> to the function
returned by <code><a href='https://rdrr.io/pkg/chandwich/man/adjust_loglik.html'>adjust_loglik</a></code>, that is, the type of
adjustment made to the independence loglikelihood function in creating
an adjusted loglikelihood function.  See <strong>Details</strong> and
<strong>Value</strong> in <code><a href='https://rdrr.io/pkg/chandwich/man/adjust_loglik.html'>adjust_loglik</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A object (a list) of class <code>"retlev", "lax"</code> with the
  components</p>
<dt>rl_sym,rl_prof </dt><dd><p>Named numeric vectors containing the respective
    lower 100<code>level</code>% limit, the MLE and the upper
    100<code>level</code>% limit for the return level.
    If <code>prof = FALSE</code> then <code>rl_prof</code> will be missing.</p></dd>
  <dt>rl_se </dt><dd><p>Estimated standard error of the return level.</p></dd>
  <dt>max_loglik,crit,for_plot </dt><dd><p>If <code>prof = TRUE</code> then
    these components will be present, containing respectively: the maximised
    loglikelihood; the critical value and a matrix with return levels in
    the first column (<code>ret_levs</code>) and the corresponding values of the
    (adjusted) profile loglikelihood (<code>prof_loglik</code>).</p></dd>
  <dt>m,level </dt><dd><p>The input values of <code>m</code> and <code>level</code>.</p></dd>
  <dt>call </dt><dd><p>The call to <code>return_level</code>.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>At present <code>return_level</code> only supports GEV models.</p>
<p>Care must be taken in specifying the input value of <code>m</code>,
  taking into account the parameterisation of the original fit.</p>
<p>For GEV models it is common for each observation to relate to a year.
  In this event the <code>m</code>-observation return level is an <code>m</code>-year
  return level.</p>
<p>For details about the definition and estimation of return levels see
  Chapter 3 and 4 of Coles (2001).</p>
<p>The profile likelihood-based intervals are calculated by
  reparameterising in terms of the <code>m</code>-year return level and estimating
  the values at which the (adjusted) profile loglikelihood reaches
  the critical value <code>logLik(x) - 0.5 * stats::qchisq(level, 1)</code>.
  This is achieved by calculating the profile loglikelihood for a sequence
  of values of this return level as governed by <code>inc</code>. Once the profile
  loglikelhood drops below the critical value the lower and upper limits are
  estimated by interpolating linearly between the cases lying either side of
  the critical value. The smaller <code>inc</code> the more accurate (but slower)
  the calculation will be.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Coles, S. G. (2001) <em>An Introduction to Statistical
  Modeling of Extreme Values</em>, Springer-Verlag, London.
  <a href='https://doi.org/10.1007/978-1-4471-3675-0_3'>https://doi.org/10.1007/978-1-4471-3675-0_3</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='plot.retlev.html'>plot.retlev</a></code> for plotting the profile loglikelihood
  for a return level.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>got_evd</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ns-load.html'>requireNamespace</a></span><span class='op'>(</span><span class='st'>"evd"</span>, quietly <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='va'>got_evd</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>evd</span><span class='op'>)</span>
  <span class='co'># An example from the evd::fgev documentation</span>
  <span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>4082019</span><span class='op'>)</span>
  <span class='va'>uvdata</span> <span class='op'>&lt;-</span> <span class='fu'>evd</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/evd/man/gev.html'>rgev</a></span><span class='op'>(</span><span class='fl'>100</span>, loc <span class='op'>=</span> <span class='fl'>0.13</span>, scale <span class='op'>=</span> <span class='fl'>1.1</span>, shape <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span>
  <span class='va'>M1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/evd/man/fgev.html'>fgev</a></span><span class='op'>(</span><span class='va'>uvdata</span><span class='op'>)</span>
  <span class='va'>adj_fgev</span> <span class='op'>&lt;-</span> <span class='fu'><a href='alogLik.html'>alogLik</a></span><span class='op'>(</span><span class='va'>M1</span><span class='op'>)</span>
  <span class='co'># Large inc set here for speed, sacrificing accuracy</span>
  <span class='va'>rl</span> <span class='op'>&lt;-</span> <span class='fu'>return_level</span><span class='op'>(</span><span class='va'>adj_fgev</span>, inc <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>rl</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>rl</span><span class='op'>)</span>
<span class='op'>}</span>
</div><div class='img'><img src='return_level-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt;     lower       mle     upper 
#&gt;  5.337685  6.992529 10.354765 </div><div class='input'>
<span class='va'>got_ismev</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ns-load.html'>requireNamespace</a></span><span class='op'>(</span><span class='st'>"ismev"</span>, quietly <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='va'>got_ismev</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://www.ral.ucar.edu/~ericg/softextreme.php'>ismev</a></span><span class='op'>)</span>
  <span class='co'># An example from the ismev::gev.fit documentation</span>
  <span class='va'>gev_fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ismev/man/gev.fit.html'>gev.fit</a></span><span class='op'>(</span><span class='fu'>revdbayes</span><span class='fu'>::</span><span class='va'><a href='https://paulnorthrop.github.io/revdbayes/reference/portpirie.html'>portpirie</a></span>, show <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  <span class='va'>adj_gev_fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='alogLik.html'>alogLik</a></span><span class='op'>(</span><span class='va'>gev_fit</span><span class='op'>)</span>
  <span class='co'># Large inc set here for speed, sacrificing accuracy</span>
  <span class='va'>rl</span> <span class='op'>&lt;-</span> <span class='fu'>return_level</span><span class='op'>(</span><span class='va'>adj_gev_fit</span>, inc <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>rl</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>rl</span><span class='op'>)</span>
<span class='op'>}</span>
</div><div class='img'><img src='return_level-2.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt;    lower      mle    upper 
#&gt; 4.518708 4.688429 5.070614 </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Paul J. Northrop, Camellia Yin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


