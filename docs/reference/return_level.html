<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Return Level Inferences for Stationary Extreme Value Models — return_level • lax</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Return Level Inferences for Stationary Extreme Value Models — return_level"><meta name="description" content="Calculates point estimates and confidence intervals for m-year
return levels for stationary extreme value fitted model objects
returned from alogLik.  Two types of interval may be returned:
(a) intervals based on approximate large-sample normality of the maximum
likelihood estimator for return level, which are symmetric about the point
estimate, and (b) profile likelihood-based intervals based on an (adjusted)
loglikelihood."><meta property="og:description" content="Calculates point estimates and confidence intervals for m-year
return levels for stationary extreme value fitted model objects
returned from alogLik.  Two types of interval may be returned:
(a) intervals based on approximate large-sample normality of the maximum
likelihood estimator for return level, which are symmetric about the point
estimate, and (b) profile likelihood-based intervals based on an (adjusted)
loglikelihood."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lax</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.2.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/lax-vignette.html">An overview of lax</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/paulnorthrop/lax/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Return Level Inferences for Stationary Extreme Value Models</h1>
      <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/lax/blob/HEAD/R/return_level.R"><code>R/return_level.R</code></a></small>
      <div class="d-none name"><code>return_level.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates point estimates and confidence intervals for <code>m</code>-year
return levels for <strong>stationary</strong> extreme value fitted model objects
returned from <code><a href="alogLik.html">alogLik</a></code>.  Two types of interval may be returned:
(a) intervals based on approximate large-sample normality of the maximum
likelihood estimator for return level, which are symmetric about the point
estimate, and (b) profile likelihood-based intervals based on an (adjusted)
loglikelihood.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">return_level</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  m <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  npy <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  prof <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  inc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vertical"</span>, <span class="st">"cholesky"</span>, <span class="st">"spectral"</span>, <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object inheriting from class <code>"lax"</code> returned from
<code><a href="alogLik.html">alogLik</a></code>.</p></dd>


<dt id="arg-m">m<a class="anchor" aria-label="anchor" href="#arg-m"></a></dt>
<dd><p>A numeric scalar.  The return period, in years.</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>A numeric scalar in (0, 1).  The confidence level required for
the confidence interval for the <code>m</code>-year return level.</p></dd>


<dt id="arg-npy">npy<a class="anchor" aria-label="anchor" href="#arg-npy"></a></dt>
<dd><p>A numeric scalar.  The (mean) number of observations per year.
<strong>Setting this appropriately is important</strong>. See <strong>Details</strong>.</p></dd>


<dt id="arg-prof">prof<a class="anchor" aria-label="anchor" href="#arg-prof"></a></dt>
<dd><p>A logical scalar.  Should we calculate intervals based on
profile loglikelihood?</p></dd>


<dt id="arg-inc">inc<a class="anchor" aria-label="anchor" href="#arg-inc"></a></dt>
<dd><p>A numeric scalar. Only relevant if <code>prof = TRUE</code>. The
increment in return level by which we move upwards and downwards from the
MLE for the return level in the search for the lower and upper confidence
limits.  If this is not supplied then <code>inc</code> is set to one hundredth
of the length of the symmetric confidence interval for return level.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>A character scalar.  The argument <code>type</code> to the function
returned by <code><a href="https://paulnorthrop.github.io/chandwich/reference/adjust_loglik.html" class="external-link">adjust_loglik</a></code>, that is, the type of
adjustment made to the independence loglikelihood function in creating
an adjusted loglikelihood function.  See <strong>Details</strong> and
<strong>Value</strong> in <code><a href="https://paulnorthrop.github.io/chandwich/reference/adjust_loglik.html" class="external-link">adjust_loglik</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A object (a list) of class <code>"retlev", "lax"</code> with the
  components</p>
<dl><dt>rl_sym,rl_prof </dt>
<dd><p>Named numeric vectors containing the respective
    lower 100<code>level</code>% limit, the MLE and the upper
    100<code>level</code>% limit for the return level.
    If <code>prof = FALSE</code> then <code>rl_prof</code> will be missing.</p></dd>

  <dt>rl_se </dt>
<dd><p>Estimated standard error of the return level.</p></dd>

  <dt>max_loglik,crit,for_plot </dt>
<dd><p>If <code>prof = TRUE</code> then
    these components will be present, containing respectively: the maximised
    loglikelihood; the critical value and a matrix with return levels in
    the first column (<code>ret_levs</code>) and the corresponding values of the
    (adjusted) profile loglikelihood (<code>prof_loglik</code>).</p></dd>

  <dt>m,level </dt>
<dd><p>The input values of <code>m</code> and <code>level</code>.</p></dd>

  <dt>call </dt>
<dd><p>The call to <code>return_level</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>At present <code>return_level</code> only supports GEV models.</p>
<p><strong>Care must be taken in specifying the input value of <code>npy</code>.</strong></p><ul><li><p><strong>GEV models</strong>: it is common to have one observation per year,
     either because the data are annual maxima or because for each year only
     the maximum value over a particular season is extracted from the raw
     data. In this case, <code>npy = 1</code>, which is the default.  If instead
     we extract the maximum values over the first and second halves of each
     year then <code>npy = 2</code>.</p></li>
<li><p><strong>Binomial-GP models</strong>: <code>npy</code> provides information
     about the (intended) frequency of sampling in time, that is, the number
     of observations that would be observed in a year if there are no
     missing values.  If the number of observations may vary between years
     then <code>npy</code> should be set equal to the mean number of observations
     per year.</p></li>
</ul><p><strong>Supplying <code>npy</code> for binomial-GP models.</strong>
  The value of <code>npy</code> (or an equivalent, perhaps differently named,
  quantity) may have been set in the call to fit a GP model.
  For example, the <code><a href="https://rdrr.io/pkg/ismev/man/gpd.fit.html" class="external-link">gpd.fit()</a></code> function in the <code>ismev</code> package
  has a <code>npy</code> argument and the value of <code>npy</code> is stored in the
  fitted model object.  If <code>npy</code> is supplied by the user in the call to
  <code>return_level</code> then this will be used in preference to the value
  stored in the fitted model object.  If these two values differ then no
  warning will be given.</p>
<p>For details of the definition and estimation of return levels see the
  Inference for return levels vignette.</p>
<p>The profile likelihood-based intervals are calculated by
  reparameterising in terms of the <code>m</code>-year return level and estimating
  the values at which the (adjusted) profile loglikelihood reaches
  the critical value <code>logLik(x) - 0.5 * stats::qchisq(level, 1)</code>.
  This is achieved by calculating the profile loglikelihood for a sequence
  of values of this return level as governed by <code>inc</code>. Once the profile
  loglikelihood drops below the critical value the lower and upper limits are
  estimated by interpolating linearly between the cases lying either side of
  the critical value. The smaller <code>inc</code> the more accurate (but slower)
  the calculation will be.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Coles, S. G. (2001) <em>An Introduction to Statistical
  Modeling of Extreme Values</em>, Springer-Verlag, London.
  <a href="https://doi.org/10.1007/978-1-4471-3675-0_3" class="external-link">doi:10.1007/978-1-4471-3675-0_3</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="plot.retlev.html">plot.retlev</a></code> for plotting the profile loglikelihood
  for a return level.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># GEV model -----</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">got_evd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"evd"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="va">got_evd</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">evd</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># An example from the evd::fgev documentation</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">4082019</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">uvdata</span> <span class="op">&lt;-</span> <span class="fu">evd</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/evd/man/gev.html" class="external-link">rgev</a></span><span class="op">(</span><span class="fl">100</span>, loc <span class="op">=</span> <span class="fl">0.13</span>, scale <span class="op">=</span> <span class="fl">1.1</span>, shape <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">M1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/evd/man/fgev.html" class="external-link">fgev</a></span><span class="op">(</span><span class="va">uvdata</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">adj_fgev</span> <span class="op">&lt;-</span> <span class="fu"><a href="alogLik.html">alogLik</a></span><span class="op">(</span><span class="va">M1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Large inc set here for speed, sacrificing accuracy</span></span></span>
<span class="r-in"><span>  <span class="va">rl</span> <span class="op">&lt;-</span> <span class="fu">return_level</span><span class="op">(</span><span class="va">adj_fgev</span>, inc <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">rl</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">rl</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="return_level-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lower       mle     upper </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5.337685  6.992529 10.354765 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">got_ismev</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"ismev"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="va">got_ismev</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ismev</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># An example from the ismev::gev.fit documentation</span></span></span>
<span class="r-in"><span>  <span class="va">gev_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ismev/man/gev.fit.html" class="external-link">gev.fit</a></span><span class="op">(</span><span class="fu">revdbayes</span><span class="fu">::</span><span class="va"><a href="https://paulnorthrop.github.io/revdbayes/reference/portpirie.html" class="external-link">portpirie</a></span>, show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">adj_gev_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="alogLik.html">alogLik</a></span><span class="op">(</span><span class="va">gev_fit</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Large inc set here for speed, sacrificing accuracy</span></span></span>
<span class="r-in"><span>  <span class="va">rl</span> <span class="op">&lt;-</span> <span class="fu">return_level</span><span class="op">(</span><span class="va">adj_gev_fit</span>, inc <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">rl</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">rl</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="return_level-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    lower      mle    upper </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.518708 4.688429 5.070614 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Binomial-GP model -----</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="va">got_ismev</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ismev</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">rain</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># An example from the ismev::gpd.fit documentation</span></span></span>
<span class="r-in"><span>  <span class="va">rain_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ismev/man/gpd.fit.html" class="external-link">gpd.fit</a></span><span class="op">(</span><span class="va">rain</span>, <span class="fl">10</span>, show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">adj_rain_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="alogLik.html">alogLik</a></span><span class="op">(</span><span class="va">rain_fit</span>, binom <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Large inc set here for speed, sacrificing accuracy</span></span></span>
<span class="r-in"><span>  <span class="va">rl</span> <span class="op">&lt;-</span> <span class="fu">return_level</span><span class="op">(</span><span class="va">adj_rain_fit</span>, inc <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">rl</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">rl</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="return_level-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lower       mle     upper </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  76.00807  87.01603 103.60984 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="va">got_ismev</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># Use Newlyn seas surges data from the exdex package</span></span></span>
<span class="r-in"><span>  <span class="va">surges</span> <span class="op">&lt;-</span> <span class="fu">exdex</span><span class="fu">::</span><span class="va"><a href="https://paulnorthrop.github.io/exdex/reference/newlyn.html" class="external-link">newlyn</a></span></span></span>
<span class="r-in"><span>  <span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">surges</span>, probs <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">newlyn_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ismev/man/gpd.fit.html" class="external-link">gpd.fit</a></span><span class="op">(</span><span class="va">surges</span>, <span class="va">u</span>, show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Create 5 clusters each corresponding approximately to 1 year of data</span></span></span>
<span class="r-in"><span>  <span class="va">cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, each <span class="op">=</span> <span class="fl">579</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">adj_newlyn_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="alogLik.html">alogLik</a></span><span class="op">(</span><span class="va">newlyn_fit</span>, cluster <span class="op">=</span> <span class="va">cluster</span>, binom <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                            cadjust <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">rl</span> <span class="op">&lt;-</span> <span class="fu">return_level</span><span class="op">(</span><span class="va">adj_newlyn_fit</span>, inc <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">rl</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Add inference about the extremal index theta, using K = 1</span></span></span>
<span class="r-in"><span>  <span class="va">adj_newlyn_theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="alogLik.html">alogLik</a></span><span class="op">(</span><span class="va">newlyn_fit</span>, cluster <span class="op">=</span> <span class="va">cluster</span>, binom <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                              k <span class="op">=</span> <span class="fl">1</span>, cadjust <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">rl</span> <span class="op">&lt;-</span> <span class="fu">return_level</span><span class="op">(</span><span class="va">adj_newlyn_theta</span>, inc <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">rl</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> return_level(x = adj_newlyn_theta, inc = 0.02)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MLE and 95% confidence limits for the 100-year return level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Normal interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  lower     mle   upper  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.7489  0.8424  0.9359  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Profile likelihood-based interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  lower     mle   upper  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.7593  0.8424  0.9450  </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul J. Northrop, Camellia Yin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

