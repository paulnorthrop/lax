<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Maximum-likelihood (Re-)Fitting using the ismev package — ismev_refits • lax</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Maximum-likelihood (Re-)Fitting using the ismev package — ismev_refits"><meta name="description" content="These are a slightly modified versions of the gev.fit,
gpd.fit, pp.fit and
rlarg.fit functions in the ismev
package.
The modification is to add to the returned object regression design matrices
for the parameters of the model.  That is,
xdat, ydat, mulink, siglink, shlink and matrices
mumat, sigmat, shmat for the location, scale and shape parameters
gev.fit, pp.fit and
rlarg.fit, and xdat,
ydat, siglink, shlink and matrices sigmat, shmat for the
scale and shape parameters for gpd.fit."><meta property="og:description" content="These are a slightly modified versions of the gev.fit,
gpd.fit, pp.fit and
rlarg.fit functions in the ismev
package.
The modification is to add to the returned object regression design matrices
for the parameters of the model.  That is,
xdat, ydat, mulink, siglink, shlink and matrices
mumat, sigmat, shmat for the location, scale and shape parameters
gev.fit, pp.fit and
rlarg.fit, and xdat,
ydat, siglink, shlink and matrices sigmat, shmat for the
scale and shape parameters for gpd.fit."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lax</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.2.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/lax-vignette.html">An overview of lax</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/paulnorthrop/lax/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Maximum-likelihood (Re-)Fitting using the ismev package</h1>
      <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/lax/blob/HEAD/R/ismev_refits.R"><code>R/ismev_refits.R</code></a></small>
      <div class="d-none name"><code>ismev_refits.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These are a slightly modified versions of the <code>gev.fit</code>,
<code>gpd.fit</code>, <code>pp.fit</code> and
<code>rlarg.fit</code> functions in the <code>ismev</code>
package.
The modification is to add to the returned object regression design matrices
for the parameters of the model.  That is,
<code>xdat, ydat, mulink, siglink, shlink</code> and matrices
<code>mumat, sigmat, shmat</code> for the location, scale and shape parameters
<code>gev.fit</code>, <code>pp.fit</code> and
<code>rlarg.fit</code>, and <code>xdat</code>,
<code>ydat, siglink, shlink</code> and matrices <code>sigmat, shmat</code> for the
scale and shape parameters for <code>gpd.fit</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gev_refit</span><span class="op">(</span></span>
<span>  <span class="va">xdat</span>,</span>
<span>  ydat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mul <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sigl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  shl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mulink <span class="op">=</span> <span class="va">identity</span>,</span>
<span>  siglink <span class="op">=</span> <span class="va">identity</span>,</span>
<span>  shlink <span class="op">=</span> <span class="va">identity</span>,</span>
<span>  muinit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  siginit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  shinit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  show <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"Nelder-Mead"</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gpd_refit</span><span class="op">(</span></span>
<span>  <span class="va">xdat</span>,</span>
<span>  <span class="va">threshold</span>,</span>
<span>  npy <span class="op">=</span> <span class="fl">365</span>,</span>
<span>  ydat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sigl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  shl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  siglink <span class="op">=</span> <span class="va">identity</span>,</span>
<span>  shlink <span class="op">=</span> <span class="va">identity</span>,</span>
<span>  siginit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  shinit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  show <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"Nelder-Mead"</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">pp_refit</span><span class="op">(</span></span>
<span>  <span class="va">xdat</span>,</span>
<span>  <span class="va">threshold</span>,</span>
<span>  npy <span class="op">=</span> <span class="fl">365</span>,</span>
<span>  ydat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mul <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sigl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  shl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mulink <span class="op">=</span> <span class="va">identity</span>,</span>
<span>  siglink <span class="op">=</span> <span class="va">identity</span>,</span>
<span>  shlink <span class="op">=</span> <span class="va">identity</span>,</span>
<span>  muinit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  siginit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  shinit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  show <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"Nelder-Mead"</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">rlarg_refit</span><span class="op">(</span></span>
<span>  <span class="va">xdat</span>,</span>
<span>  r <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">xdat</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>  ydat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mul <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sigl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  shl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mulink <span class="op">=</span> <span class="va">identity</span>,</span>
<span>  siglink <span class="op">=</span> <span class="va">identity</span>,</span>
<span>  shlink <span class="op">=</span> <span class="va">identity</span>,</span>
<span>  muinit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  siginit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  shinit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  show <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"Nelder-Mead"</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-xdat">xdat<a class="anchor" aria-label="anchor" href="#arg-xdat"></a></dt>
<dd><p>A numeric vector of data to be fitted.</p></dd>


<dt id="arg-ydat">ydat<a class="anchor" aria-label="anchor" href="#arg-ydat"></a></dt>
<dd><p>A matrix of covariates for generalized linear modelling
    of the parameters (or <code>NULL</code> (the default) for stationary
    fitting). The number of rows should be the same as the length
    of <code>xdat</code>.</p></dd>


<dt id="arg-mul-sigl-shl">mul, sigl, shl<a class="anchor" aria-label="anchor" href="#arg-mul-sigl-shl"></a></dt>
<dd><p>Numeric vectors of integers, giving the columns
    of <code>ydat</code> that contain covariates for generalized linear
    modelling of the location, scale and shape parameters repectively
    (or <code>NULL</code> (the default) if the corresponding parameter is
    stationary).</p></dd>


<dt id="arg-mulink-siglink-shlink">mulink, siglink, shlink<a class="anchor" aria-label="anchor" href="#arg-mulink-siglink-shlink"></a></dt>
<dd><p>Inverse link functions for generalized
    linear modelling of the location, scale and shape parameters
    repectively.</p></dd>


<dt id="arg-muinit-siginit-shinit">muinit, siginit, shinit<a class="anchor" aria-label="anchor" href="#arg-muinit-siginit-shinit"></a></dt>
<dd><p>numeric of length equal to total number
    of parameters used to model the location, scale or shape parameter(s),
    resp.  See Details section for default (NULL) initial values.</p></dd>


<dt id="arg-show">show<a class="anchor" aria-label="anchor" href="#arg-show"></a></dt>
<dd><p>Logical; if <code>TRUE</code> (the default), print details of
    the fit.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>The optimization method (see <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> for
    details).</p></dd>


<dt id="arg-maxit">maxit<a class="anchor" aria-label="anchor" href="#arg-maxit"></a></dt>
<dd><p>The maximum number of iterations.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other control parameters for the optimization. These
    are passed to components of the <code>control</code> argument of
    <code>optim</code>.</p></dd>


<dt id="arg-threshold">threshold<a class="anchor" aria-label="anchor" href="#arg-threshold"></a></dt>
<dd><p>The threshold; a single number or a numeric
    vector of the same length as <code>xdat</code>.</p></dd>


<dt id="arg-npy">npy<a class="anchor" aria-label="anchor" href="#arg-npy"></a></dt>
<dd><p>The number of observations per year/block.</p></dd>


<dt id="arg-r">r<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>The largest <code>r</code> order statistics are used for
    the fitted model.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Heffernan, J. E. and Stephenson, A. G. (2018). ismev: An
  Introduction to Statistical Modeling of Extreme Values.
  R package version 1.42.
  <a href="https://CRAN.R-project.org/package=ismev" class="external-link">https://CRAN.R-project.org/package=ismev</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># We need the ismev package</span></span></span>
<span class="r-in"><span><span class="va">got_ismev</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"ismev"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="va">got_ismev</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ismev</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu">gev.fit</span><span class="op">(</span><span class="fu">revdbayes</span><span class="fu">::</span><span class="va"><a href="https://paulnorthrop.github.io/revdbayes/reference/portpirie.html" class="external-link">portpirie</a></span>, show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu">gev_refit</span><span class="op">(</span><span class="fu">revdbayes</span><span class="fu">::</span><span class="va"><a href="https://paulnorthrop.github.io/revdbayes/reference/portpirie.html" class="external-link">portpirie</a></span>, show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">rain</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu">gpd.fit</span><span class="op">(</span><span class="va">rain</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu">gpd_refit</span><span class="op">(</span><span class="va">rain</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu">pp.fit</span><span class="op">(</span><span class="va">rain</span>, <span class="fl">10</span>, show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu">pp_refit</span><span class="op">(</span><span class="va">rain</span>, <span class="fl">10</span>, show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">venice</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu">rlarg.fit</span><span class="op">(</span><span class="va">venice</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>, muinit <span class="op">=</span> <span class="fl">120.54</span>, siginit <span class="op">=</span> <span class="fl">12.78</span>,</span></span>
<span class="r-in"><span>                   shinit <span class="op">=</span> <span class="op">-</span><span class="fl">0.1129</span>, show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu">rlarg_refit</span><span class="op">(</span><span class="va">venice</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>, muinit <span class="op">=</span> <span class="fl">120.54</span>, siginit <span class="op">=</span> <span class="fl">12.78</span>,</span></span>
<span class="r-in"><span>                   shinit <span class="op">=</span> <span class="op">-</span><span class="fl">0.1129</span>, show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul J. Northrop, Camellia Yin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

