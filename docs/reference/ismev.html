<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Loglikelihood adjustment for ismev fits — ismev • lax</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Loglikelihood adjustment for ismev fits — ismev" />
<meta property="og:description" content="S3 alogLik method to perform loglikelihood adjustment for fitted
extreme value model objects returned from the functions
gev.fit, gpd.fit,
pp.fit and rlarg.fit in the
ismev package.  If regression modelling is used then
the model will need to be re-fitted, see ismev_refits." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lax</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">1.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/lax-vignette.html">An overview of lax</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/paulnorthrop/lax/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Loglikelihood adjustment for ismev fits</h1>
    <small class="dont-index">Source: <a href='http://github.com/paulnorthrop/lax/blob/master/R/ismev.R'><code>R/ismev.R</code></a></small>
    <div class="hidden name"><code>ismev.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>S3 <code>alogLik</code> method to perform loglikelihood adjustment for fitted
extreme value model objects returned from the functions
<code><a href='https://rdrr.io/pkg/ismev/man/gev.fit.html'>gev.fit</a></code>, <code><a href='https://rdrr.io/pkg/ismev/man/gpd.fit.html'>gpd.fit</a></code>,
<code><a href='https://rdrr.io/pkg/ismev/man/pp.fit.html'>pp.fit</a></code> and <code><a href='https://rdrr.io/pkg/ismev/man/rlarg.fit.html'>rlarg.fit</a></code> in the
<code><a href='https://rdrr.io/pkg/ismev/man/ismev.html'>ismev</a></code> package.  If regression modelling is used then
the model will need to be re-fitted, see <code><a href='ismev_refits.html'>ismev_refits</a></code>.</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for gev.fit</span>
<span class='fu'><a href='alogLik.html'>alogLik</a></span><span class='op'>(</span><span class='va'>x</span>, cluster <span class='op'>=</span> <span class='cn'>NULL</span>, use_vcov <span class='op'>=</span> <span class='cn'>TRUE</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for pp.fit</span>
<span class='fu'><a href='alogLik.html'>alogLik</a></span><span class='op'>(</span><span class='va'>x</span>, cluster <span class='op'>=</span> <span class='cn'>NULL</span>, use_vcov <span class='op'>=</span> <span class='cn'>TRUE</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for gpd.fit</span>
<span class='fu'><a href='alogLik.html'>alogLik</a></span><span class='op'>(</span><span class='va'>x</span>, cluster <span class='op'>=</span> <span class='cn'>NULL</span>, use_vcov <span class='op'>=</span> <span class='cn'>TRUE</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for rlarg.fit</span>
<span class='fu'><a href='alogLik.html'>alogLik</a></span><span class='op'>(</span><span class='va'>x</span>, cluster <span class='op'>=</span> <span class='cn'>NULL</span>, use_vcov <span class='op'>=</span> <span class='cn'>TRUE</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A fitted model object with certain associated S3 methods.
See <strong>Details</strong>.</p></td>
    </tr>
    <tr>
      <th>cluster</th>
      <td><p>A vector or factor indicating from which cluster the
respective loglikelihood contributions from <code>loglik</code> originate.
This must have the same length as the vector returned by the
<code>logLikVec</code> method for an object like <code>x</code>.
If <code>cluster</code> is not supplied (i.e. is <code>NULL</code>) then it is
assumed that each observation forms its own cluster.
See <strong>Details</strong>.</p></td>
    </tr>
    <tr>
      <th>use_vcov</th>
      <td><p>A logical scalar.  Should we use the <code>vcov</code> S3 method
for <code>x</code> (if this exists) to estimate the Hessian of the independence
loglikelihood to be passed as the argument <code>H</code> to
<code><a href='https://rdrr.io/pkg/chandwich/man/adjust_loglik.html'>adjust_loglik</a></code>?
Otherwise, <code>H</code> is estimated inside
<code><a href='https://rdrr.io/pkg/chandwich/man/adjust_loglik.html'>adjust_loglik</a></code> using
<code><a href='https://rdrr.io/r/stats/optim.html'>optimHess</a></code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments to be passed to the functions in the
sandwich package <code><a href='https://rdrr.io/pkg/sandwich/man/meat.html'>meat</a></code> (if <code>cluster = NULL</code>),
or <code><a href='https://rdrr.io/pkg/sandwich/man/vcovCL.html'>meatCL</a></code> (if <code>cluster</code> is not
<code>NULL</code>).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object inheriting from class <code>"chandwich"</code>.  See
  <code><a href='https://rdrr.io/pkg/chandwich/man/adjust_loglik.html'>adjust_loglik</a></code>.
  <code><a href='https://rdrr.io/r/base/class.html'>class(x)</a></code> is a vector of length 5. The first 3 components are
  <code><a href='https://rdrr.io/r/base/c.html'>c("lax", "chandwich", "ismev")</a></code>.
  The remaining 2 components depend on the model that was fitted.
  The 4th component is:
  <code>"gev"</code> if <code><a href='https://rdrr.io/pkg/ismev/man/gev.fit.html'>gev.fit</a></code>
  (or <code><a href='ismev_refits.html'>gev_refit</a></code>) was used;
  <code>"gpd"</code> if <code><a href='https://rdrr.io/pkg/ismev/man/gpd.fit.html'>gpd.fit</a></code>
  (or <code><a href='ismev_refits.html'>gpd_refit</a></code>) was used;
  <code>"pp"</code> <code><a href='https://rdrr.io/pkg/ismev/man/pp.fit.html'>pp.fit</a></code>
  (or <code><a href='ismev_refits.html'>pp_refit</a></code>) was used;
  <code>"rlarg"</code> <code><a href='https://rdrr.io/pkg/ismev/man/rlarg.fit.html'>rlarg.fit</a></code>
  (or <code><a href='ismev_refits.html'>rlarg_refit</a></code>) was used.
  The 5th component is
  <code>"stat"</code> if <code>x$trans = FALSE</code> and
  <code>"nonstat"</code> if <code>x$trans = TRUE</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>See <code><a href='alogLik.html'>alogLik</a></code> for details.</p>
<p>If regression modelling is used then the ismev functions
<code><a href='https://rdrr.io/pkg/ismev/man/gev.fit.html'>gev.fit</a></code>, <code><a href='https://rdrr.io/pkg/ismev/man/gpd.fit.html'>gpd.fit</a></code>,
<code><a href='https://rdrr.io/pkg/ismev/man/pp.fit.html'>pp.fit</a></code> and <code><a href='https://rdrr.io/pkg/ismev/man/rlarg.fit.html'>rlarg.fit</a></code>
return residuals but <code><a href='alogLik.html'>alogLik</a></code> needs the raw data.
The model will need to be re-fitted, using one of the functions in
<code><a href='ismev_refits.html'>ismev_refits</a></code>, and the user will be prompted to do this
by an error message produced by <code><a href='alogLik.html'>alogLik</a></code>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Chandler, R. E. and Bate, S. (2007). Inference for clustered
  data using the independence loglikelihood. <em>Biometrika</em>,
  <strong>94</strong>(1), 167-183. <a href='http://doi.org/10.1093/biomet/asm015'>http://doi.org/10.1093/biomet/asm015</a></p>
<p>Zeleis (2006) Object-Oriented Computation and Sandwich
  Estimators.  <em>Journal of Statistical Software</em>, <strong>16</strong>, 1-16.
  <a href='http://doi.org/10.18637/jss.v016.i09'>http://doi.org/10.18637/jss.v016.i09</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='alogLik.html'>alogLik</a></code>: loglikelihood adjustment for model fits.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># We need the ismev package</span>
<span class='va'>got_ismev</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ns-load.html'>requireNamespace</a></span><span class='op'>(</span><span class='st'>"ismev"</span>, quietly <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='va'>got_ismev</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://www.ral.ucar.edu/~ericg/softextreme.php'>ismev</a></span><span class='op'>)</span>

  <span class='co'># GEV model -----</span>

  <span class='co'># An example from the ismev::gev.fit documentation</span>
  <span class='va'>gev_fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ismev/man/gev.fit.html'>gev.fit</a></span><span class='op'>(</span><span class='fu'>revdbayes</span><span class='fu'>::</span><span class='va'><a href='https://paulnorthrop.github.io/revdbayes/reference/portpirie.html'>portpirie</a></span>, show <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  <span class='va'>adj_gev_fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='alogLik.html'>alogLik</a></span><span class='op'>(</span><span class='va'>gev_fit</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>adj_gev_fit</span><span class='op'>)</span>

  <span class='co'># An example from chapter 6 of Coles (2001)</span>
  <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>fremantle</span><span class='op'>)</span>
  <span class='va'>xdat</span> <span class='op'>&lt;-</span> <span class='va'>fremantle</span><span class='op'>[</span>, <span class='st'>"SeaLevel"</span><span class='op'>]</span>
  <span class='co'># Set year 1897 to 1 for consistency with page 113 of Coles (2001)</span>
  <span class='va'>ydat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>fremantle</span><span class='op'>[</span>, <span class='st'>"Year"</span><span class='op'>]</span> <span class='op'>-</span> <span class='fl'>1896</span>, <span class='va'>fremantle</span><span class='op'>[</span>, <span class='st'>"SOI"</span><span class='op'>]</span><span class='op'>)</span>
  <span class='va'>gev_fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='ismev_refits.html'>gev_refit</a></span><span class='op'>(</span><span class='va'>xdat</span>, <span class='va'>ydat</span>, mul <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span>, show <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  <span class='va'>adj_gev_fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='alogLik.html'>alogLik</a></span><span class='op'>(</span><span class='va'>gev_fit</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>adj_gev_fit</span><span class='op'>)</span>

  <span class='co'># An example from Chandler and Bate (2007)</span>
  <span class='va'>gev_fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='ismev_refits.html'>gev_refit</a></span><span class='op'>(</span><span class='va'>ow</span><span class='op'>$</span><span class='va'>temp</span>, <span class='va'>ow</span>, mul <span class='op'>=</span> <span class='fl'>4</span>, sigl <span class='op'>=</span> <span class='fl'>4</span>, shl <span class='op'>=</span> <span class='fl'>4</span>,
                       show <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  <span class='va'>adj_gev_fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='alogLik.html'>alogLik</a></span><span class='op'>(</span><span class='va'>gev_fit</span>, cluster <span class='op'>=</span> <span class='va'>ow</span><span class='op'>$</span><span class='va'>year</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>adj_gev_fit</span><span class='op'>)</span>
  <span class='co'># Get closer to the values reported in Table 2 of Chandler and Bate (2007)</span>
  <span class='va'>gev_fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='ismev_refits.html'>gev_refit</a></span><span class='op'>(</span><span class='va'>ow</span><span class='op'>$</span><span class='va'>temp</span>, <span class='va'>ow</span>, mul <span class='op'>=</span> <span class='fl'>4</span>, sigl <span class='op'>=</span> <span class='fl'>4</span>, shl <span class='op'>=</span> <span class='fl'>4</span>,
                       show <span class='op'>=</span> <span class='cn'>FALSE</span>, method <span class='op'>=</span> <span class='st'>"BFGS"</span><span class='op'>)</span>
  <span class='co'># Call sandwich::meatCL() with cadjust = FALSE</span>
  <span class='va'>adj_gev_fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='alogLik.html'>alogLik</a></span><span class='op'>(</span><span class='va'>gev_fit</span>, cluster <span class='op'>=</span> <span class='va'>ow</span><span class='op'>$</span><span class='va'>year</span>, cadjust <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>adj_gev_fit</span><span class='op'>)</span>

  <span class='co'># GP model -----</span>

  <span class='co'># An example from the ismev::gpd.fit documentation</span>
  <span class='co'># \donttest{</span>
  <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>rain</span><span class='op'>)</span>
  <span class='va'>rain_fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ismev/man/gpd.fit.html'>gpd.fit</a></span><span class='op'>(</span><span class='va'>rain</span>, <span class='fl'>10</span>, show <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  <span class='va'>adj_rain_fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='alogLik.html'>alogLik</a></span><span class='op'>(</span><span class='va'>rain_fit</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>adj_rain_fit</span><span class='op'>)</span>
  <span class='co'># Continuing to the regression example on page 119 of Coles (2001)</span>
  <span class='va'>ydat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>rain</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>/</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>rain</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>reg_rain_fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='ismev_refits.html'>gpd_refit</a></span><span class='op'>(</span><span class='va'>rain</span>, <span class='fl'>30</span>, ydat <span class='op'>=</span> <span class='va'>ydat</span>, sigl <span class='op'>=</span> <span class='fl'>1</span>, siglink <span class='op'>=</span> <span class='va'>exp</span>,
                            show <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  <span class='va'>adj_reg_rain_fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='alogLik.html'>alogLik</a></span><span class='op'>(</span><span class='va'>reg_rain_fit</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>adj_reg_rain_fit</span><span class='op'>)</span>
  <span class='co'># }</span>
  <span class='co'># PP model -----</span>

  <span class='co'># An example from the ismev::pp.fit documentation</span>
  <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>rain</span><span class='op'>)</span>
  <span class='co'># Start from the mle to save time</span>
  <span class='va'>init</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>40.55755732</span>, <span class='fl'>8.99195409</span>, <span class='fl'>0.05088103</span><span class='op'>)</span>
  <span class='va'>muinit</span> <span class='op'>&lt;-</span> <span class='va'>init</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>
  <span class='va'>siginit</span> <span class='op'>&lt;-</span> <span class='va'>init</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>
  <span class='va'>shinit</span> <span class='op'>&lt;-</span> <span class='va'>init</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>]</span>
  <span class='va'>rain_fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='ismev_refits.html'>pp_refit</a></span><span class='op'>(</span><span class='va'>rain</span>, <span class='fl'>10</span>, muinit <span class='op'>=</span> <span class='va'>muinit</span>, siginit <span class='op'>=</span> <span class='va'>siginit</span>,
                       shinit <span class='op'>=</span> <span class='va'>shinit</span>, show <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  <span class='va'>adj_rain_fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='alogLik.html'>alogLik</a></span><span class='op'>(</span><span class='va'>rain_fit</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>adj_rain_fit</span><span class='op'>)</span>

  <span class='co'># An example from chapter 7 of Coles (2001).</span>
  <span class='co'># Code from demo ismev::wooster.temps</span>
  <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>wooster</span><span class='op'>)</span>
  <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>along <span class='op'>=</span> <span class='va'>wooster</span><span class='op'>)</span>
  <span class='va'>usin</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>a</span>, <span class='va'>b</span>, <span class='va'>d</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>a</span> <span class='op'>+</span> <span class='va'>b</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>sin</a></span><span class='op'>(</span><span class='op'>(</span><span class='op'>(</span><span class='va'>x</span> <span class='op'>-</span> <span class='va'>d</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>2</span> <span class='op'>*</span> <span class='va'>pi</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>365.25</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>}</span>
  <span class='va'>wu</span> <span class='op'>&lt;-</span> <span class='fu'>usin</span><span class='op'>(</span><span class='va'>x</span>, <span class='op'>-</span><span class='fl'>30</span>, <span class='fl'>25</span>, <span class='op'>-</span><span class='fl'>75</span><span class='op'>)</span>
  <span class='va'>ydat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>sin</a></span><span class='op'>(</span><span class='fl'>2</span> <span class='op'>*</span> <span class='va'>pi</span> <span class='op'>*</span> <span class='va'>x</span> <span class='op'>/</span> <span class='fl'>365.25</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>cos</a></span><span class='op'>(</span><span class='fl'>2</span> <span class='op'>*</span> <span class='va'>pi</span> <span class='op'>*</span><span class='va'>x</span> <span class='op'>/</span> <span class='fl'>365.25</span><span class='op'>)</span><span class='op'>)</span>
  <span class='co'># Start from the mle to save time</span>
  <span class='va'>init</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>15.3454188</span>, <span class='fl'>9.6001844</span>, <span class='fl'>28.5493828</span>, <span class='fl'>0.5067104</span>, <span class='fl'>0.1023488</span>,
            <span class='fl'>0.5129783</span>, <span class='op'>-</span><span class='fl'>0.3504231</span><span class='op'>)</span>
  <span class='va'>muinit</span> <span class='op'>&lt;-</span> <span class='va'>init</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span>
  <span class='va'>siginit</span> <span class='op'>&lt;-</span> <span class='va'>init</span><span class='op'>[</span><span class='fl'>4</span><span class='op'>:</span><span class='fl'>6</span><span class='op'>]</span>
  <span class='va'>shinit</span> <span class='op'>&lt;-</span> <span class='va'>init</span><span class='op'>[</span><span class='fl'>7</span><span class='op'>]</span>
  <span class='va'>wooster.pp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='ismev_refits.html'>pp_refit</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>wooster</span>, threshold <span class='op'>=</span> <span class='va'>wu</span>, ydat <span class='op'>=</span> <span class='va'>ydat</span>, mul <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span>,
                         sigl <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span>, siglink <span class='op'>=</span> <span class='va'>exp</span>, method <span class='op'>=</span> <span class='st'>"BFGS"</span>,
                         muinit <span class='op'>=</span> <span class='va'>muinit</span>, siginit <span class='op'>=</span> <span class='va'>siginit</span>, shinit <span class='op'>=</span> <span class='va'>shinit</span>,
                         show <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  <span class='va'>adj_pp_fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='alogLik.html'>alogLik</a></span><span class='op'>(</span><span class='va'>wooster.pp</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>adj_pp_fit</span><span class='op'>)</span>

  <span class='co'># r-largest order statistics model -----</span>

  <span class='co'># An example based on the ismev::rlarg.fit() documentation</span>
  <span class='va'>vdata</span> <span class='op'>&lt;-</span> <span class='fu'>revdbayes</span><span class='fu'>::</span><span class='va'><a href='https://paulnorthrop.github.io/revdbayes/reference/venice.html'>venice</a></span>
  <span class='va'>rfit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ismev/man/rlarg.fit.html'>rlarg.fit</a></span><span class='op'>(</span><span class='va'>vdata</span>, muinit <span class='op'>=</span> <span class='fl'>120.54</span>, siginit <span class='op'>=</span> <span class='fl'>12.78</span>,
                    shinit <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1129</span>, show <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  <span class='va'>adj_rfit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='alogLik.html'>alogLik</a></span><span class='op'>(</span><span class='va'>rfit</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>adj_rfit</span><span class='op'>)</span>

  <span class='co'># \donttest{</span>
  <span class='co'># Adapt this example to add a covariate</span>
  <span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>30102019</span><span class='op'>)</span>
  <span class='va'>ydat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>vdata</span><span class='op'>)</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>vdata</span><span class='op'>)</span>, <span class='fl'>1</span><span class='op'>)</span>
  <span class='va'>rfit2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='ismev_refits.html'>rlarg_refit</a></span><span class='op'>(</span><span class='va'>vdata</span>, ydat <span class='op'>=</span> <span class='va'>ydat</span>, mul <span class='op'>=</span> <span class='fl'>1</span>,
                       muinit <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>120.54</span>, <span class='fl'>0</span><span class='op'>)</span>, siginit <span class='op'>=</span> <span class='fl'>12.78</span>,
                       shinit <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1129</span>, show <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  <span class='va'>adj_rfit2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='alogLik.html'>alogLik</a></span><span class='op'>(</span><span class='va'>rfit2</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>adj_rfit2</span><span class='op'>)</span>
  <span class='co'># }</span>
<span class='op'>}</span>
</div><div class='output co'>#&gt; <span class='message'>Loading required package: mgcv</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: nlme</span></div><div class='output co'>#&gt; <span class='message'>This is mgcv 1.8-35. For overview type 'help("mgcv-package")'.</span></div><div class='output co'>#&gt;            MLE      SE adj. SE
#&gt; loc   122.8000 1.77100 3.17100
#&gt; loc1   -5.5400 2.65700 4.46100
#&gt; scale  12.6500 0.53290 0.81270
#&gt; shape  -0.1172 0.01948 0.02741</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Paul J. Northrop, Camellia Yin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


