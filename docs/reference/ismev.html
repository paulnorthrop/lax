<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Loglikelihood adjustment for ismev fits — ismev • lax</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Loglikelihood adjustment for ismev fits — ismev"><meta name="description" content="S3 alogLik method to perform loglikelihood adjustment for fitted
extreme value model objects returned from the functions
gev.fit, gpd.fit,
pp.fit and rlarg.fit in the
ismev package.  If regression modelling is used then
the model will need to be re-fitted, see ismev_refits."><meta property="og:description" content="S3 alogLik method to perform loglikelihood adjustment for fitted
extreme value model objects returned from the functions
gev.fit, gpd.fit,
pp.fit and rlarg.fit in the
ismev package.  If regression modelling is used then
the model will need to be re-fitted, see ismev_refits."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lax</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.2.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/lax-vignette.html">An overview of lax</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/paulnorthrop/lax/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Loglikelihood adjustment for ismev fits</h1>
      <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/lax/blob/HEAD/R/ismev.R"><code>R/ismev.R</code></a></small>
      <div class="d-none name"><code>ismev.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>S3 <code>alogLik</code> method to perform loglikelihood adjustment for fitted
extreme value model objects returned from the functions
<code><a href="https://rdrr.io/pkg/ismev/man/gev.fit.html" class="external-link">gev.fit</a></code>, <code><a href="https://rdrr.io/pkg/ismev/man/gpd.fit.html" class="external-link">gpd.fit</a></code>,
<code><a href="https://rdrr.io/pkg/ismev/man/pp.fit.html" class="external-link">pp.fit</a></code> and <code><a href="https://rdrr.io/pkg/ismev/man/rlarg.fit.html" class="external-link">rlarg.fit</a></code> in the
<code><a href="https://rdrr.io/pkg/ismev/man/ismev.html" class="external-link">ismev</a></code> package.  If regression modelling is used then
the model will need to be re-fitted, see <code><a href="ismev_refits.html">ismev_refits</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'gev.fit'</span></span>
<span><span class="fu"><a href="alogLik.html">alogLik</a></span><span class="op">(</span><span class="va">x</span>, cluster <span class="op">=</span> <span class="cn">NULL</span>, use_vcov <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'pp.fit'</span></span>
<span><span class="fu"><a href="alogLik.html">alogLik</a></span><span class="op">(</span><span class="va">x</span>, cluster <span class="op">=</span> <span class="cn">NULL</span>, use_vcov <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'gpd.fit'</span></span>
<span><span class="fu"><a href="alogLik.html">alogLik</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  cluster <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use_vcov <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  binom <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">k</span>,</span>
<span>  inc_cens <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'rlarg.fit'</span></span>
<span><span class="fu"><a href="alogLik.html">alogLik</a></span><span class="op">(</span><span class="va">x</span>, cluster <span class="op">=</span> <span class="cn">NULL</span>, use_vcov <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A fitted model object with certain associated S3 methods.
See <strong>Details</strong>.</p></dd>


<dt id="arg-cluster">cluster<a class="anchor" aria-label="anchor" href="#arg-cluster"></a></dt>
<dd><p>A vector or factor indicating from which cluster the
  respective log-likelihood contributions from <code>loglik</code> originate.
  The length of <code>cluster</code> must be consistent with the <code>estfun</code>
  method to be used in the estimation of the 'meat' <code>V</code> of the sandwich
  estimator of the covariance matrix of the parameters to be passed to
  <code><a href="https://paulnorthrop.github.io/chandwich/reference/adjust_loglik.html" class="external-link">adjust_loglik</a></code>.  In most cases, <code>cluster</code>
  must have length equal to the number of observations in data.  The
  exception is the GP (only) model (<code>binom = FALSE</code>), where the
  <code>cluster</code> may either contain a value for each observation in the raw
  data, or for each threshold exceedance in the data.</p>
<p>If <code>cluster</code> is not supplied (is <code>NULL</code>) then it is
  assumed that each observation forms its own cluster.
  See <strong>Details</strong> for further details.</p></dd>


<dt id="arg-use-vcov">use_vcov<a class="anchor" aria-label="anchor" href="#arg-use-vcov"></a></dt>
<dd><p>A logical scalar.  Should we use the <code>vcov</code> S3 method
for <code>x</code> (if this exists) to estimate the Hessian of the independence
loglikelihood to be passed as the argument <code>H</code> to
<code><a href="https://paulnorthrop.github.io/chandwich/reference/adjust_loglik.html" class="external-link">adjust_loglik</a></code>?
Otherwise, <code>H</code> is estimated inside
<code><a href="https://paulnorthrop.github.io/chandwich/reference/adjust_loglik.html" class="external-link">adjust_loglik</a></code> using
<code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optimHess</a></code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments to be passed to the functions in the
sandwich package <code><a href="https://sandwich.R-Forge.R-project.org/reference/meat.html" class="external-link">meat</a></code> (if <code>cluster = NULL</code>),
or <code><a href="https://sandwich.R-Forge.R-project.org/reference/vcovCL.html" class="external-link">meatCL</a></code> (if <code>cluster</code> is not
<code>NULL</code>).</p></dd>


<dt id="arg-binom">binom<a class="anchor" aria-label="anchor" href="#arg-binom"></a></dt>
<dd><p>A logical scalar.  This option is only relevant to
<strong>GP models</strong> and is only available in the <strong>stationary</strong>
(no covariates) case. If <code>binom = FALSE</code> then loglikelihood
adjustment is only performed using the GP model. If <code>binom = TRUE</code>
then loglikelihood adjustment is also performed for inferences about the
probability of threshold exceedance, using a Bernoulli model for the
instances of threshold exceedance.</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>A non-negative integer scalar.  This option is only relevant to
<strong>GP models</strong> and is only available in the <strong>stationary</strong>
(no covariates) case.  If <code>k</code> is supplied then it is passed as the
run parameter \(K\) to <code><a href="https://paulnorthrop.github.io/exdex/reference/kgaps.html" class="external-link">kgaps</a></code> for making inferences
about the extremal index \(\theta\) using the \(K\)-gaps model of
Suveges and Davison (2010).</p></dd>


<dt id="arg-inc-cens">inc_cens<a class="anchor" aria-label="anchor" href="#arg-inc-cens"></a></dt>
<dd><p>A logical scalar.  This argument is only relevant if
<code>k</code> is supplied.  Passed to <code><a href="https://paulnorthrop.github.io/exdex/reference/kgaps.html" class="external-link">kgaps</a></code> to indicate
whether or not to include censored inter-exceedance times, relating to
the first and last observations.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object inheriting from class <code>"chandwich"</code>.  See
  <code><a href="https://paulnorthrop.github.io/chandwich/reference/adjust_loglik.html" class="external-link">adjust_loglik</a></code>.</p>
<p><code>class(x)</code> is a vector of length 5. The first 3 components are
  <code>c("lax", "chandwich", "ismev")</code>.
  The remaining 2 components depend on the model that was fitted.
  The 4th component is:
  <code>"gev"</code> if <code><a href="https://rdrr.io/pkg/ismev/man/gev.fit.html" class="external-link">gev.fit</a></code>
  (or <code><a href="ismev_refits.html">gev_refit</a></code>) was used;
  <code>"gpd"</code> if <code><a href="https://rdrr.io/pkg/ismev/man/gpd.fit.html" class="external-link">gpd.fit</a></code>
  (or <code><a href="ismev_refits.html">gpd_refit</a></code>) was used;
  <code>"pp"</code> <code><a href="https://rdrr.io/pkg/ismev/man/pp.fit.html" class="external-link">pp.fit</a></code>
  (or <code><a href="ismev_refits.html">pp_refit</a></code>) was used;
  <code>"rlarg"</code> <code><a href="https://rdrr.io/pkg/ismev/man/rlarg.fit.html" class="external-link">rlarg.fit</a></code>
  (or <code><a href="ismev_refits.html">rlarg_refit</a></code>) was used.
  The 5th component is
  <code>"stat"</code> if <code>x$trans = FALSE</code> and
  <code>"nonstat"</code> if <code>x$trans = TRUE</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>See <code><a href="alogLik.html">alogLik</a></code> for details.</p>
<p>If regression modelling is used then the ismev functions
<code><a href="https://rdrr.io/pkg/ismev/man/gev.fit.html" class="external-link">gev.fit</a></code>, <code><a href="https://rdrr.io/pkg/ismev/man/gpd.fit.html" class="external-link">gpd.fit</a></code>,
<code><a href="https://rdrr.io/pkg/ismev/man/pp.fit.html" class="external-link">pp.fit</a></code> and <code><a href="https://rdrr.io/pkg/ismev/man/rlarg.fit.html" class="external-link">rlarg.fit</a></code>
return residuals but <code><a href="alogLik.html">alogLik</a></code> needs the raw data.
The model will need to be re-fitted, using one of the functions in
<code><a href="ismev_refits.html">ismev_refits</a></code>, and the user will be prompted to do this
by an error message produced by <code><a href="alogLik.html">alogLik</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Chandler, R. E. and Bate, S. (2007). Inference for clustered
  data using the independence loglikelihood. <em>Biometrika</em>,
  <strong>94</strong>(1), 167-183. <a href="https://doi.org/10.1093/biomet/asm015" class="external-link">doi:10.1093/biomet/asm015</a></p>
<p>Suveges, M. and Davison, A. C. (2010) Model
  misspecification in peaks over threshold analysis, <em>The Annals of
  Applied Statistics</em>, <strong>4</strong>(1), 203-221.
  <a href="https://doi.org/10.1214/09-AOAS292" class="external-link">doi:10.1214/09-AOAS292</a></p>
<p>Zeileis (2006) Object-Oriented Computation and Sandwich
  Estimators.  <em>Journal of Statistical Software</em>, <strong>16</strong>, 1-16.
  <a href="https://doi.org/10.18637/jss.v016.i09" class="external-link">doi:10.18637/jss.v016.i09</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="alogLik.html">alogLik</a></code>: loglikelihood adjustment for model fits.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># We need the ismev package</span></span></span>
<span class="r-in"><span><span class="va">got_ismev</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"ismev"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="va">got_ismev</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ismev</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># GEV model -----</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># An example from the ismev::gev.fit documentation</span></span></span>
<span class="r-in"><span>  <span class="va">gev_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ismev/man/gev.fit.html" class="external-link">gev.fit</a></span><span class="op">(</span><span class="fu">revdbayes</span><span class="fu">::</span><span class="va"><a href="https://paulnorthrop.github.io/revdbayes/reference/portpirie.html" class="external-link">portpirie</a></span>, show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">adj_gev_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="alogLik.html">alogLik</a></span><span class="op">(</span><span class="va">gev_fit</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">adj_gev_fit</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># An example from chapter 6 of Coles (2001)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">fremantle</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">xdat</span> <span class="op">&lt;-</span> <span class="va">fremantle</span><span class="op">[</span>, <span class="st">"SeaLevel"</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="co"># Set year 1897 to 1 for consistency with page 113 of Coles (2001)</span></span></span>
<span class="r-in"><span>  <span class="va">ydat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">fremantle</span><span class="op">[</span>, <span class="st">"Year"</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1896</span>, <span class="va">fremantle</span><span class="op">[</span>, <span class="st">"SOI"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">gev_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="ismev_refits.html">gev_refit</a></span><span class="op">(</span><span class="va">xdat</span>, <span class="va">ydat</span>, mul <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">adj_gev_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="alogLik.html">alogLik</a></span><span class="op">(</span><span class="va">gev_fit</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">adj_gev_fit</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># An example from Chandler and Bate (2007)</span></span></span>
<span class="r-in"><span>  <span class="va">gev_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="ismev_refits.html">gev_refit</a></span><span class="op">(</span><span class="va">ow</span><span class="op">$</span><span class="va">temp</span>, <span class="va">ow</span>, mul <span class="op">=</span> <span class="fl">4</span>, sigl <span class="op">=</span> <span class="fl">4</span>, shl <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>                       show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">adj_gev_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="alogLik.html">alogLik</a></span><span class="op">(</span><span class="va">gev_fit</span>, cluster <span class="op">=</span> <span class="va">ow</span><span class="op">$</span><span class="va">year</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">adj_gev_fit</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Get closer to the values reported in Table 2 of Chandler and Bate (2007)</span></span></span>
<span class="r-in"><span>  <span class="va">gev_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="ismev_refits.html">gev_refit</a></span><span class="op">(</span><span class="va">ow</span><span class="op">$</span><span class="va">temp</span>, <span class="va">ow</span>, mul <span class="op">=</span> <span class="fl">4</span>, sigl <span class="op">=</span> <span class="fl">4</span>, shl <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>                       show <span class="op">=</span> <span class="cn">FALSE</span>, method <span class="op">=</span> <span class="st">"BFGS"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Call sandwich::meatCL() with cadjust = FALSE</span></span></span>
<span class="r-in"><span>  <span class="va">adj_gev_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="alogLik.html">alogLik</a></span><span class="op">(</span><span class="va">gev_fit</span>, cluster <span class="op">=</span> <span class="va">ow</span><span class="op">$</span><span class="va">year</span>, cadjust <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">adj_gev_fit</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># GP model -----</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># An example from the ismev::gpd.fit documentation</span></span></span>
<span class="r-in"><span>  <span class="co"># \donttest{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">rain</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">rain_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ismev/man/gpd.fit.html" class="external-link">gpd.fit</a></span><span class="op">(</span><span class="va">rain</span>, <span class="fl">10</span>, show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">adj_rain_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="alogLik.html">alogLik</a></span><span class="op">(</span><span class="va">rain_fit</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">adj_rain_fit</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Continuing to the regression example on page 119 of Coles (2001)</span></span></span>
<span class="r-in"><span>  <span class="va">ydat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">rain</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">rain</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">reg_rain_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="ismev_refits.html">gpd_refit</a></span><span class="op">(</span><span class="va">rain</span>, <span class="fl">30</span>, ydat <span class="op">=</span> <span class="va">ydat</span>, sigl <span class="op">=</span> <span class="fl">1</span>, siglink <span class="op">=</span> <span class="va">exp</span>,</span></span>
<span class="r-in"><span>                            show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">adj_reg_rain_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="alogLik.html">alogLik</a></span><span class="op">(</span><span class="va">reg_rain_fit</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">adj_reg_rain_fit</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># }</span></span></span>
<span class="r-in"><span>  <span class="co"># Binomial-GP model -----</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Use Newlyn seas surges data from the exdex package</span></span></span>
<span class="r-in"><span>  <span class="va">surges</span> <span class="op">&lt;-</span> <span class="fu">exdex</span><span class="fu">::</span><span class="va"><a href="https://paulnorthrop.github.io/exdex/reference/newlyn.html" class="external-link">newlyn</a></span></span></span>
<span class="r-in"><span>  <span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">surges</span>, probs <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">newlyn_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ismev/man/gpd.fit.html" class="external-link">gpd.fit</a></span><span class="op">(</span><span class="va">surges</span>, <span class="va">u</span>, show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Create 5 clusters each corresponding approximately to 1 year of data</span></span></span>
<span class="r-in"><span>  <span class="va">cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, each <span class="op">=</span> <span class="fl">579</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">adj_newlyn_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="alogLik.html">alogLik</a></span><span class="op">(</span><span class="va">newlyn_fit</span>, cluster <span class="op">=</span> <span class="va">cluster</span>, binom <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                            cadjust <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">adj_newlyn_fit</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">adj_newlyn_fit</span>, <span class="st">"pu_aloglik"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Add inference about the extremal index theta, using K = 1</span></span></span>
<span class="r-in"><span>  <span class="va">adj_newlyn_theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="alogLik.html">alogLik</a></span><span class="op">(</span><span class="va">newlyn_fit</span>, cluster <span class="op">=</span> <span class="va">cluster</span>, binom <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                              k <span class="op">=</span> <span class="fl">1</span>, cadjust <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">adj_newlyn_theta</span>, <span class="st">"theta"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># PP model -----</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># An example from the ismev::pp.fit documentation</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">rain</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Start from the mle to save time</span></span></span>
<span class="r-in"><span>  <span class="va">init</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40.55755732</span>, <span class="fl">8.99195409</span>, <span class="fl">0.05088103</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">muinit</span> <span class="op">&lt;-</span> <span class="va">init</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">siginit</span> <span class="op">&lt;-</span> <span class="va">init</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">shinit</span> <span class="op">&lt;-</span> <span class="va">init</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">rain_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="ismev_refits.html">pp_refit</a></span><span class="op">(</span><span class="va">rain</span>, <span class="fl">10</span>, muinit <span class="op">=</span> <span class="va">muinit</span>, siginit <span class="op">=</span> <span class="va">siginit</span>,</span></span>
<span class="r-in"><span>                       shinit <span class="op">=</span> <span class="va">shinit</span>, show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">adj_rain_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="alogLik.html">alogLik</a></span><span class="op">(</span><span class="va">rain_fit</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">adj_rain_fit</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># An example from chapter 7 of Coles (2001).</span></span></span>
<span class="r-in"><span>  <span class="co"># Code from demo ismev::wooster.temps</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">wooster</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>along <span class="op">=</span> <span class="va">wooster</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">usin</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">a</span>, <span class="va">b</span>, <span class="va">d</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">d</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span><span class="op">)</span> <span class="op">/</span> <span class="fl">365.25</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="va">wu</span> <span class="op">&lt;-</span> <span class="fu">usin</span><span class="op">(</span><span class="va">x</span>, <span class="op">-</span><span class="fl">30</span>, <span class="fl">25</span>, <span class="op">-</span><span class="fl">75</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">ydat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">x</span> <span class="op">/</span> <span class="fl">365.25</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span><span class="va">x</span> <span class="op">/</span> <span class="fl">365.25</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Start from the mle to save time</span></span></span>
<span class="r-in"><span>  <span class="va">init</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15.3454188</span>, <span class="fl">9.6001844</span>, <span class="fl">28.5493828</span>, <span class="fl">0.5067104</span>, <span class="fl">0.1023488</span>,</span></span>
<span class="r-in"><span>            <span class="fl">0.5129783</span>, <span class="op">-</span><span class="fl">0.3504231</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">muinit</span> <span class="op">&lt;-</span> <span class="va">init</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">siginit</span> <span class="op">&lt;-</span> <span class="va">init</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">shinit</span> <span class="op">&lt;-</span> <span class="va">init</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">wooster.pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="ismev_refits.html">pp_refit</a></span><span class="op">(</span><span class="op">-</span><span class="va">wooster</span>, threshold <span class="op">=</span> <span class="va">wu</span>, ydat <span class="op">=</span> <span class="va">ydat</span>, mul <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>                         sigl <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, siglink <span class="op">=</span> <span class="va">exp</span>, method <span class="op">=</span> <span class="st">"BFGS"</span>,</span></span>
<span class="r-in"><span>                         muinit <span class="op">=</span> <span class="va">muinit</span>, siginit <span class="op">=</span> <span class="va">siginit</span>, shinit <span class="op">=</span> <span class="va">shinit</span>,</span></span>
<span class="r-in"><span>                         show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">adj_pp_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="alogLik.html">alogLik</a></span><span class="op">(</span><span class="va">wooster.pp</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">adj_pp_fit</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># r-largest order statistics model -----</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># An example based on the ismev::rlarg.fit() documentation</span></span></span>
<span class="r-in"><span>  <span class="va">vdata</span> <span class="op">&lt;-</span> <span class="fu">revdbayes</span><span class="fu">::</span><span class="va"><a href="https://paulnorthrop.github.io/revdbayes/reference/venice.html" class="external-link">venice</a></span></span></span>
<span class="r-in"><span>  <span class="va">rfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ismev/man/rlarg.fit.html" class="external-link">rlarg.fit</a></span><span class="op">(</span><span class="va">vdata</span>, muinit <span class="op">=</span> <span class="fl">120.54</span>, siginit <span class="op">=</span> <span class="fl">12.78</span>,</span></span>
<span class="r-in"><span>                    shinit <span class="op">=</span> <span class="op">-</span><span class="fl">0.1129</span>, show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">adj_rfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="alogLik.html">alogLik</a></span><span class="op">(</span><span class="va">rfit</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">adj_rfit</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># \donttest{</span></span></span>
<span class="r-in"><span>  <span class="co"># Adapt this example to add a covariate</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">30102019</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">ydat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">vdata</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">vdata</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">rfit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="ismev_refits.html">rlarg_refit</a></span><span class="op">(</span><span class="va">vdata</span>, ydat <span class="op">=</span> <span class="va">ydat</span>, mul <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                       muinit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">120.54</span>, <span class="fl">0</span><span class="op">)</span>, siginit <span class="op">=</span> <span class="fl">12.78</span>,</span></span>
<span class="r-in"><span>                       shinit <span class="op">=</span> <span class="op">-</span><span class="fl">0.1129</span>, show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">adj_rfit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="alogLik.html">alogLik</a></span><span class="op">(</span><span class="va">rfit2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">adj_rfit2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># }</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: mgcv</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: nlme</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> This is mgcv 1.9-3. For overview type 'help("mgcv-package")'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            MLE      SE adj. SE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> loc   122.8000 1.77100 3.17100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> loc1   -5.5400 2.65700 4.46100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale  12.6500 0.53290 0.81270</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape  -0.1172 0.01948 0.02741</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul J. Northrop, Camellia Yin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

