<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Loglikelihood adjustment for model fits — alogLik • lax</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Loglikelihood adjustment for model fits — alogLik" />
<meta property="og:description" content="This function is generic.  It performs adjustment of the loglikelihood
associated with fitted model objects, following
Chandler and Bate (2007).
Certain classes of extreme value model objects are supported automatically.
For details see the alogLik help pages for the packages:
evd,
evir,
extRemes,
fExtremes,
ismev,
mev,
POT,
texmex.
User-supplied objects can also be supported: the requirements for these
objects are explained in Details." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lax</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/lax-vignette.html">An overview of lax</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/paulnorthrop/lax">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Loglikelihood adjustment for model fits</h1>
    <small class="dont-index">Source: <a href='https://github.com/paulnorthrop/lax/blob/master/R/alogLik_methods.R'><code>R/alogLik_methods.R</code></a></small>
    <div class="hidden name"><code>alogLik.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function is generic.  It performs adjustment of the loglikelihood
associated with fitted model objects, following
<a href='http://doi.org/10.1093/biomet/asm015'>Chandler and Bate (2007)</a>.
Certain classes of extreme value model objects are supported automatically.
For details see the <code>alogLik</code> help pages for the packages:
<code><a href='evd.html'>evd</a></code>,
<code><a href='evir.html'>evir</a></code>,
<code><a href='extRemes.html'>extRemes</a></code>,
<code><a href='fExtremes.html'>fExtremes</a></code>,
<code><a href='ismev.html'>ismev</a></code>,
<code><a href='mev.html'>mev</a></code>,
<code><a href='POT.html'>POT</a></code>,
<code><a href='texmex.html'>texmex</a></code>.
User-supplied objects can also be supported: the requirements for these
objects are explained in <strong>Details</strong>.</p>
    </div>

    <pre class="usage"><span class='fu'>alogLik</span>(<span class='no'>x</span>, <span class='kw'>cluster</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>use_vcov</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A fitted model object with certain associated S3 methods.
See <strong>Details</strong>.</p></td>
    </tr>
    <tr>
      <th>cluster</th>
      <td><p>A vector or factor indicating from which cluster the
respective loglikelihood contributions from <code>loglik</code> originate.
This must have the same length as the vector returned by the
<code>logLikVec</code> method for an object like <code>x</code>.
If <code>cluster</code> is not supplied (i.e. is <code>NULL</code>) then it is
assumed that each observation forms its own cluster.
See <strong>Details</strong>.</p></td>
    </tr>
    <tr>
      <th>use_vcov</th>
      <td><p>A logical scalar.  Should we use the <code>vcov</code> S3 method
for <code>x</code> (if this exists) to estimate the Hessian of the independence
loglikelihood to be passed as the argument <code>H</code> to
<code><a href='https://rdrr.io/pkg/chandwich/man/adjust_loglik.html'>adjust_loglik</a></code>?
Otherwise, <code>H</code> is estimated inside
<code><a href='https://rdrr.io/pkg/chandwich/man/adjust_loglik.html'>adjust_loglik</a></code> using
<code><a href='https://rdrr.io/r/stats/optim.html'>optimHess</a></code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments to be passed to the functions in the
sandwich package <code><a href='https://rdrr.io/pkg/sandwich/man/meat.html'>meat</a></code> (if <code>cluster = NULL</code>),
or <code><a href='https://rdrr.io/pkg/sandwich/man/vcovCL.html'>meatCL</a></code> (if <code>cluster</code> is not
<code>NULL</code>).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object inheriting from class <code>"chandwich"</code>.  See
  <code><a href='https://rdrr.io/pkg/chandwich/man/adjust_loglik.html'>adjust_loglik</a></code>.</p>
<p>If <code>x</code> is one of the supported models then <code><a href='https://rdrr.io/r/base/class.html'>class(x)</a></code> is a
  vector of length 5. The first 3 components are
  <code><a href='https://rdrr.io/r/base/c.html'>c("lax", "chandwich", "name_of_package")</a></code>, where
  <code>"name_of_package"</code> is the name of the package from which the input
  object <code>x</code> originated.  The remaining 2 components depend on the
  model that was fitted.  See the documentation of the relevant package
  for details:
  <code><a href='evd.html'>evd</a></code>,
  <code><a href='evir.html'>evir</a></code>,
  <code><a href='extRemes.html'>extRemes</a></code>,
  <code><a href='fExtremes.html'>fExtremes</a></code>,
  <code><a href='ismev.html'>ismev</a></code>,
  <code><a href='mev.html'>mev</a></code>,
  <code><a href='POT.html'>POT</a></code>,
  <code><a href='texmex.html'>texmex</a></code>.</p>
<p>Otherwise, <code><a href='https://rdrr.io/r/base/class.html'>class(x)</a></code> is <code><a href='https://rdrr.io/r/base/c.html'>c("lax", "chandwich", class(x))</a></code>.</p>
<p>Objects returned from `aloglik` have `anova`, `coef`, `confint`, `logLik`,
  `nobs`, `plot`, `print`, `summary` and `vcov` methods.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Object <code>x</code> <em>must</em> have the following S3
  methods:</p><ul>
<li><p><code>logLikVec: </code>returns a vector of the contributions to the
      independence loglikelihood from individual observations;</p></li>
<li><p><code>coef: </code>returns a vector of model coefficients, see
      <code><a href='https://rdrr.io/r/stats/coef.html'>coef</a></code>;</p></li>
<li><p><code>nobs: </code>returns the number of (non-missing) observations
      used in a model fit, see <code><a href='https://rdrr.io/r/stats/nobs.html'>nobs</a></code>;</p></li>
</ul><p>and <em>may</em> have the following S3 methods</p><ul>
<li><p><code>vcov: </code>returns the estimated variance-covariance matrix of
      the (main) parameters of a fitted model, see
      <code><a href='https://rdrr.io/r/stats/vcov.html'>vcov</a></code>;</p></li>
<li><p><code>estfun: </code>returns an \(n x k\) matrix, in which each
      column gives the derivative of the loglikelihood at each of \(n\)
      observation with respect to the \(k\) parameters of the model, see
      <code><a href='https://rdrr.io/pkg/sandwich/man/estfun.html'>estfun</a></code>.</p></li>
</ul><p>Loglikelihood adjustment is performed using the
  <code><a href='https://rdrr.io/pkg/chandwich/man/adjust_loglik.html'>adjust_loglik</a></code> function in the
  <code><a href='https://rdrr.io/pkg/chandwich/man/chandwich.html'>chandwich</a></code> package.
  The relevant arguments to <code><a href='https://rdrr.io/pkg/chandwich/man/adjust_loglik.html'>adjust_loglik</a></code>, namely
  <code>loglik, mle, H</code> and <code>V</code>, are created based on the class of
  the object <code>x</code>.</p>
<p>If a <code>vcov</code> method is not available, or if <code>use_vcov = FALSE</code>,
  then the variance-covariance matrix of the MLE (from which <code>H</code> is
  calculated) is estimated inside <code><a href='https://rdrr.io/pkg/chandwich/man/adjust_loglik.html'>adjust_loglik</a></code>
  using <code><a href='https://rdrr.io/r/stats/optim.html'>optimHess</a></code>.</p>
<p>The <code>sandwich</code> package is used to estimate the variance matrix
  <code>V</code> of the score vector: <code><a href='https://rdrr.io/pkg/sandwich/man/meat.html'>meat</a></code> is used if
  <code>cluster = NULL</code>; <code><a href='https://rdrr.io/pkg/sandwich/man/vcovCL.html'>meatCL</a></code> is used if
  <code>cluster</code> is not <code>NULL</code>.
  If <code>cluster</code> is <code>NULL</code> then any arguments of
  <code><a href='https://rdrr.io/pkg/sandwich/man/vcovCL.html'>meatCL</a></code> present in ... will be ignored.
  Similarly, if <code>cluster</code> is not <code>NULL</code> then any arguments of
  <code><a href='https://rdrr.io/pkg/sandwich/man/meat.html'>meat</a></code> present in ... will be ignored.
  <code><a href='https://rdrr.io/pkg/sandwich/man/meat.html'>meat</a></code> and <code><a href='https://rdrr.io/pkg/sandwich/man/vcovCL.html'>meatCL</a></code>
  require an <code><a href='https://rdrr.io/pkg/sandwich/man/estfun.html'>estfun</a></code> method to be available, which,
  in the current context, provides matrix of score contributions.
  If a bespoke <code>estfun</code> method is not provided then this is constructed
  by estimating the score contributions using <code><a href='https://rdrr.io/pkg/numDeriv/man/jacobian.html'>jacobian</a></code>.</p>
    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>

    

<p>See the (package-specific) examples in <code><a href='evd.html'>evd</a></code>,
  <code><a href='evir.html'>evir</a></code>, <code><a href='extRemes.html'>extRemes</a></code>,<code><a href='fExtremes.html'>fExtremes</a></code>,
  <code><a href='ismev.html'>ismev</a></code>, <code><a href='mev.html'>mev</a></code>, <code><a href='POT.html'>POT</a></code> and
  <code><a href='texmex.html'>texmex</a></code>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Chandler, R. E. and Bate, S. (2007). Inference for clustered
  data using the independence loglikelihood. <em>Biometrika</em>,
  <strong>94</strong>(1), 167-183. <a href='http://doi.org/10.1093/biomet/asm015'>http://doi.org/10.1093/biomet/asm015</a></p>
<p>Zeleis (2006) Object-Oriented Computation and Sandwich
  Estimators.  <em>Journal of Statistical Software</em>, <strong>16</strong>, 1-16.
  <a href='http://doi.org/10.18637/jss.v016.i09'>http://doi.org/10.18637/jss.v016.i09</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/chandwich/man/summary.chandwich.html'>summary.chandwich</a></code>,
  <code><a href='https://rdrr.io/pkg/chandwich/man/plot.chandwich.html'>plot.chandwich</a></code>,
  <code><a href='https://rdrr.io/pkg/chandwich/man/confint.chandwich.html'>confint.chandwich</a></code>,
  <code><a href='https://rdrr.io/pkg/chandwich/man/anova.chandwich.html'>anova.chandwich</a></code>,
  <code><a href='https://rdrr.io/pkg/chandwich/man/coef.chandwich.html'>coef.chandwich</a></code>,
  <code><a href='https://rdrr.io/pkg/chandwich/man/vcov.chandwich.html'>vcov.chandwich</a></code>
  and <code><a href='https://rdrr.io/pkg/chandwich/man/logLik.chandwich.html'>logLik.chandwich</a></code>
  for S3 methods for objects of class <code>"chandwich"</code>.</p>
<p><code><a href='https://rdrr.io/pkg/chandwich/man/conf_region.html'>conf_region</a></code> for confidence regions for
  pairs of parameters.</p>
<p><code><a href='https://rdrr.io/pkg/chandwich/man/adjust_loglik.html'>adjust_loglik</a></code> in the
  <code><a href='https://rdrr.io/pkg/chandwich/man/chandwich.html'>chandwich</a></code> package to adjust a user-supplied
  loglikelihood.</p>
<p><code><a href='https://rdrr.io/pkg/sandwich/man/meat.html'>meat</a></code> and
  <code><a href='https://rdrr.io/pkg/sandwich/man/vcovCL.html'>meatCL</a></code> in the sandwich package.</p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#examples">Examples</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Paul J. Northrop, Camellia Yin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


