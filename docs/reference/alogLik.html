<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Loglikelihood adjustment for model fits. — alogLik • lax</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Loglikelihood adjustment for model fits. — alogLik"><meta name="description" content="This function is generic.  It performs adjustment of the loglikelihood
associated with fitted model objects, following Chandler and Bate (2007).
Certain classes of extreme value model objects are supported automatically.
For details see the alogLik help pages for the packages:
evd,
evir,
extRemes,
fExtremes,
ismev,
mev,
POT,
texmex.
User-supplied objects can also be supported: the requirements for these
objects are explained in Details."><meta property="og:description" content="This function is generic.  It performs adjustment of the loglikelihood
associated with fitted model objects, following Chandler and Bate (2007).
Certain classes of extreme value model objects are supported automatically.
For details see the alogLik help pages for the packages:
evd,
evir,
extRemes,
fExtremes,
ismev,
mev,
POT,
texmex.
User-supplied objects can also be supported: the requirements for these
objects are explained in Details."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lax</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.2.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/lax-vignette.html">An overview of lax</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/paulnorthrop/lax/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Loglikelihood adjustment for model fits.</h1>
      <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/lax/blob/HEAD/R/alogLik_methods.R"><code>R/alogLik_methods.R</code></a></small>
      <div class="d-none name"><code>alogLik.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is generic.  It performs adjustment of the loglikelihood
associated with fitted model objects, following Chandler and Bate (2007).
Certain classes of extreme value model objects are supported automatically.
For details see the <code>alogLik</code> help pages for the packages:
<code><a href="evd.html">evd</a></code>,
<code><a href="evir.html">evir</a></code>,
<code><a href="extRemes.html">extRemes</a></code>,
<code><a href="fExtremes.html">fExtremes</a></code>,
<code><a href="ismev.html">ismev</a></code>,
<code><a href="mev.html">mev</a></code>,
<code><a href="POT.html">POT</a></code>,
<code><a href="texmex.html">texmex</a></code>.
User-supplied objects can also be supported: the requirements for these
objects are explained in <strong>Details</strong>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">alogLik</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  cluster <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use_vcov <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  binom <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">k</span>,</span>
<span>  inc_cens <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A fitted model object with certain associated S3 methods.
See <strong>Details</strong>.</p></dd>


<dt id="arg-cluster">cluster<a class="anchor" aria-label="anchor" href="#arg-cluster"></a></dt>
<dd><p>A vector or factor indicating from which cluster the
  respective log-likelihood contributions from <code>loglik</code> originate.
  The length of <code>cluster</code> must be consistent with the <code>estfun</code>
  method to be used in the estimation of the 'meat' <code>V</code> of the sandwich
  estimator of the covariance matrix of the parameters to be passed to
  <code><a href="https://paulnorthrop.github.io/chandwich/reference/adjust_loglik.html" class="external-link">adjust_loglik</a></code>.  In most cases, <code>cluster</code>
  must have length equal to the number of observations in data.  The
  exception is the GP (only) model (<code>binom = FALSE</code>), where the
  <code>cluster</code> may either contain a value for each observation in the raw
  data, or for each threshold exceedance in the data.</p>
<p>If <code>cluster</code> is not supplied (is <code>NULL</code>) then it is
  assumed that each observation forms its own cluster.
  See <strong>Details</strong> for further details.</p></dd>


<dt id="arg-use-vcov">use_vcov<a class="anchor" aria-label="anchor" href="#arg-use-vcov"></a></dt>
<dd><p>A logical scalar.  Should we use the <code>vcov</code> S3 method
for <code>x</code> (if this exists) to estimate the Hessian of the independence
loglikelihood to be passed as the argument <code>H</code> to
<code><a href="https://paulnorthrop.github.io/chandwich/reference/adjust_loglik.html" class="external-link">adjust_loglik</a></code>?
Otherwise, <code>H</code> is estimated inside
<code><a href="https://paulnorthrop.github.io/chandwich/reference/adjust_loglik.html" class="external-link">adjust_loglik</a></code> using
<code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optimHess</a></code>.</p></dd>


<dt id="arg-binom">binom<a class="anchor" aria-label="anchor" href="#arg-binom"></a></dt>
<dd><p>A logical scalar.  This option is only relevant to
<strong>GP models</strong> and is only available in the <strong>stationary</strong>
(no covariates) case. If <code>binom = FALSE</code> then loglikelihood
adjustment is only performed using the GP model. If <code>binom = TRUE</code>
then loglikelihood adjustment is also performed for inferences about the
probability of threshold exceedance, using a Bernoulli model for the
instances of threshold exceedance.</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>A non-negative integer scalar.  This option is only relevant to
<strong>GP models</strong> and is only available in the <strong>stationary</strong>
(no covariates) case.  If <code>k</code> is supplied then it is passed as the
run parameter \(K\) to <code><a href="https://paulnorthrop.github.io/exdex/reference/kgaps.html" class="external-link">kgaps</a></code> for making inferences
about the extremal index \(\theta\) using the \(K\)-gaps model of
Suveges and Davison (2010).</p></dd>


<dt id="arg-inc-cens">inc_cens<a class="anchor" aria-label="anchor" href="#arg-inc-cens"></a></dt>
<dd><p>A logical scalar.  This argument is only relevant if
<code>k</code> is supplied.  Passed to <code><a href="https://paulnorthrop.github.io/exdex/reference/kgaps.html" class="external-link">kgaps</a></code> to indicate
whether or not to include censored inter-exceedance times, relating to
the first and last observations.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments to be passed to the functions in the
sandwich package <code><a href="https://sandwich.R-Forge.R-project.org/reference/meat.html" class="external-link">meat</a></code> (if <code>cluster = NULL</code>),
or <code><a href="https://sandwich.R-Forge.R-project.org/reference/vcovCL.html" class="external-link">meatCL</a></code> (if <code>cluster</code> is not
<code>NULL</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object inheriting from class <code>"chandwich"</code>.  See
  <code><a href="https://paulnorthrop.github.io/chandwich/reference/adjust_loglik.html" class="external-link">adjust_loglik</a></code>.</p>
<p>The original fitted model object is available as an attribute named
  <code>"original_fit"</code>, accessible using <code>attr(name, "original_fit")</code>,
  where <code>name</code> is the name of the object to which the object returned
  from <code>alogLik</code> is assigned.</p>
<p>If <code>binom = TRUE</code> then the returned object has an extra attribute
  named <code>pu_aloglik</code> that contains an object inheriting from class
  <code>"chandwich"</code> relating specifically to inferences about the
  probability of threshold exceedance. Also, the 4th component of the class
  of the returned object becomes <code>"bin-gpd"</code>.</p>
<p>If <code>k</code> is supplied then the returned object has an extra attribute
  named <code>theta</code> that contains an object inheriting from class
  <code>c("kgaps", "exdex")</code> relating specifically to inferences about the
  extremal index \(\theta\).  See the <strong>Value</strong> section in
  <code><a href="https://paulnorthrop.github.io/exdex/reference/kgaps.html" class="external-link">kgaps</a></code>.</p>
<p>If <code>x</code> is one of the supported models then the class of the returned
  object is a vector of length 5. The first 3 components are
  <code>c("lax", "chandwich", "name_of_package")</code>, where
  <code>"name_of_package"</code> is the name of the package from which the input
  object <code>x</code> originated.  The remaining 2 components depend on the
  model that was fitted.  See the documentation of the relevant package
  for details:
  <code><a href="evd.html">evd</a></code>,
  <code><a href="evir.html">evir</a></code>,
  <code><a href="extRemes.html">extRemes</a></code>,
  <code><a href="fExtremes.html">fExtremes</a></code>,
  <code><a href="ismev.html">ismev</a></code>,
  <code><a href="mev.html">mev</a></code>,
  <code><a href="POT.html">POT</a></code>,
  <code><a href="texmex.html">texmex</a></code>.</p>
<p>Otherwise, the class of the returned object is
  <code>c("lax", "chandwich", class(x))</code>.</p>
<p>Objects returned from `aloglik` have `anova`, `coef`, `confint`, `logLik`,
  `nobs`, `plot`, `print`, `summary` and `vcov` methods.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Object <code>x</code> <em>must</em> have the following S3
  methods:</p><ul><li><p><code>logLikVec</code>: returns a vector of the contributions to the
      independence loglikelihood from individual observations;</p></li>
<li><p><code>coef</code>: returns a vector of model coefficients, see
      <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></code>;</p></li>
<li><p><code>nobs</code>: returns the number of (non-missing) observations
      used in a model fit, see <code><a href="https://rdrr.io/r/stats/nobs.html" class="external-link">nobs</a></code>;</p></li>
</ul><p>and <em>may</em> have the following S3 methods</p><ul><li><p><code>vcov</code>: returns the estimated variance-covariance matrix of
      the (main) parameters of a fitted model, see
      <code><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></code>;</p></li>
<li><p><code>estfun</code>: returns an \(n\) by \(k\) matrix, in which each
      column gives the derivative of the loglikelihood at each of \(n\)
      observation with respect to the \(k\) parameters of the model, see
      <code><a href="https://sandwich.R-Forge.R-project.org/reference/estfun.html" class="external-link">estfun</a></code>.</p></li>
</ul><p>Loglikelihood adjustment is performed using the
  <code><a href="https://paulnorthrop.github.io/chandwich/reference/adjust_loglik.html" class="external-link">adjust_loglik</a></code> function in the
  <code><a href="https://paulnorthrop.github.io/chandwich/reference/chandwich-package.html" class="external-link">chandwich</a></code> package.
  The relevant arguments to <code><a href="https://paulnorthrop.github.io/chandwich/reference/adjust_loglik.html" class="external-link">adjust_loglik</a></code>, namely
  <code>loglik, mle, H</code> and <code>V</code>, are created based on the class of
  the object <code>x</code>.</p>
<p>If a <code>vcov</code> method is not available, or if <code>use_vcov = FALSE</code>,
  then the variance-covariance matrix of the MLE (from which <code>H</code> is
  calculated) is estimated inside <code><a href="https://paulnorthrop.github.io/chandwich/reference/adjust_loglik.html" class="external-link">adjust_loglik</a></code>
  using <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optimHess</a></code>.</p>
<p>The <code>sandwich</code> package is used to estimate the variance matrix
  <code>V</code> of the score vector: <code><a href="https://sandwich.R-Forge.R-project.org/reference/meat.html" class="external-link">meat</a></code> is used if
  <code>cluster = NULL</code>; <code><a href="https://sandwich.R-Forge.R-project.org/reference/vcovCL.html" class="external-link">meatCL</a></code> is used if
  <code>cluster</code> is not <code>NULL</code>.
  If <code>cluster</code> is <code>NULL</code> then any arguments of
  <code><a href="https://sandwich.R-Forge.R-project.org/reference/vcovCL.html" class="external-link">meatCL</a></code> present in ... will be ignored.
  Similarly, if <code>cluster</code> is not <code>NULL</code> then any arguments of
  <code><a href="https://sandwich.R-Forge.R-project.org/reference/meat.html" class="external-link">meat</a></code> present in ... will be ignored.
  <code><a href="https://sandwich.R-Forge.R-project.org/reference/meat.html" class="external-link">meat</a></code> and <code><a href="https://sandwich.R-Forge.R-project.org/reference/vcovCL.html" class="external-link">meatCL</a></code>
  require an <code><a href="https://sandwich.R-Forge.R-project.org/reference/estfun.html" class="external-link">estfun</a></code> method to be available, which,
  in the current context, provides matrix of score contributions.
  If a bespoke <code>estfun</code> method is not provided then this is constructed
  by estimating the score contributions using <code><a href="https://rdrr.io/pkg/numDeriv/man/jacobian.html" class="external-link">jacobian</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a></h2>


<p>See the (package-specific) examples in <code><a href="evd.html">evd</a></code>,
  <code><a href="evir.html">evir</a></code>, <code><a href="extRemes.html">extRemes</a></code>,<code><a href="fExtremes.html">fExtremes</a></code>,
  <code><a href="ismev.html">ismev</a></code>, <code><a href="mev.html">mev</a></code>, <code><a href="POT.html">POT</a></code> and
  <code><a href="texmex.html">texmex</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Chandler, R. E. and Bate, S. (2007). Inference for clustered
  data using the independence loglikelihood. <em>Biometrika</em>,
  <strong>94</strong>(1), 167-183. <a href="https://doi.org/10.1093/biomet/asm015" class="external-link">doi:10.1093/biomet/asm015</a></p>
<p>Suveges, M. and Davison, A. C. (2010) Model
  misspecification in peaks over threshold analysis, <em>The Annals of
  Applied Statistics</em>, <strong>4</strong>(1), 203-221.
  <a href="https://doi.org/10.1214/09-AOAS292" class="external-link">doi:10.1214/09-AOAS292</a></p>
<p>Zeileis (2006) Object-Oriented Computation and Sandwich
  Estimators.  <em>Journal of Statistical Software</em>, <strong>16</strong>, 1-16.
  <a href="https://doi.org/10.18637/jss.v016.i09" class="external-link">doi:10.18637/jss.v016.i09</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://paulnorthrop.github.io/chandwich/reference/summary.chandwich.html" class="external-link">summary.chandwich</a></code>,
  <code><a href="https://paulnorthrop.github.io/chandwich/reference/plot.chandwich.html" class="external-link">plot.chandwich</a></code>,
  <code><a href="https://paulnorthrop.github.io/chandwich/reference/confint.chandwich.html" class="external-link">confint.chandwich</a></code>,
  <code><a href="https://paulnorthrop.github.io/chandwich/reference/anova.chandwich.html" class="external-link">anova.chandwich</a></code>,
  <code><a href="https://paulnorthrop.github.io/chandwich/reference/coef.chandwich.html" class="external-link">coef.chandwich</a></code>,
  <code><a href="https://paulnorthrop.github.io/chandwich/reference/vcov.chandwich.html" class="external-link">vcov.chandwich</a></code>
  and <code><a href="https://paulnorthrop.github.io/chandwich/reference/logLik.chandwich.html" class="external-link">logLik.chandwich</a></code>
  for S3 methods for objects of class <code>"chandwich"</code>.</p>
<p><code><a href="https://paulnorthrop.github.io/chandwich/reference/conf_region.html" class="external-link">conf_region</a></code> for confidence regions for
  pairs of parameters.</p>
<p><code><a href="https://paulnorthrop.github.io/chandwich/reference/adjust_loglik.html" class="external-link">adjust_loglik</a></code> in the <code>chandwich</code>
  package to adjust a user-supplied loglikelihood.</p>
<p><code><a href="https://sandwich.R-Forge.R-project.org/reference/meat.html" class="external-link">meat</a></code> and
  <code><a href="https://sandwich.R-Forge.R-project.org/reference/vcovCL.html" class="external-link">meatCL</a></code> in the sandwich package.</p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul J. Northrop, Camellia Yin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

