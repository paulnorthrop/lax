<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Loglikelihood Adjustment for Extreme Value Models â€¢ lax</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Loglikelihood Adjustment for Extreme Value Models">
<meta name="description" content="Performs adjusted inferences based on model objects fitted, using maximum likelihood estimation, by the extreme value analysis packages eva &lt;https://cran.r-project.org/package=eva&gt;, evd &lt;https://cran.r-project.org/package=evd&gt;, evir &lt;https://cran.r-project.org/package=evir&gt;, extRemes &lt;https://cran.r-project.org/package=extRemes&gt;, fExtremes &lt;https://cran.r-project.org/package=fExtremes&gt;, ismev &lt;https://cran.r-project.org/package=ismev&gt;, mev &lt;https://cran.r-project.org/package=mev&gt;, POT &lt;https://cran.r-project.org/package=POT&gt; and texmex &lt;https://cran.r-project.org/package=texmex&gt;. Adjusted standard errors and an adjusted loglikelihood are provided, using the chandwich package &lt;https://cran.r-project.org/package=chandwich&gt; and the object-oriented features of the sandwich package &lt;https://cran.r-project.org/package=sandwich&gt;. The adjustment is based on a robust sandwich estimator of the parameter covariance matrix, based on the methodology in Chandler and Bate (2007) &lt;doi:10.1093/biomet/asm015&gt;. This can be used for cluster correlated data when interest lies in the parameters of the marginal distributions, or for performing inferences that are robust to certain types of model misspecification. Univariate extreme value models, including regression models, are supported.">
<meta property="og:description" content="Performs adjusted inferences based on model objects fitted, using maximum likelihood estimation, by the extreme value analysis packages eva &lt;https://cran.r-project.org/package=eva&gt;, evd &lt;https://cran.r-project.org/package=evd&gt;, evir &lt;https://cran.r-project.org/package=evir&gt;, extRemes &lt;https://cran.r-project.org/package=extRemes&gt;, fExtremes &lt;https://cran.r-project.org/package=fExtremes&gt;, ismev &lt;https://cran.r-project.org/package=ismev&gt;, mev &lt;https://cran.r-project.org/package=mev&gt;, POT &lt;https://cran.r-project.org/package=POT&gt; and texmex &lt;https://cran.r-project.org/package=texmex&gt;. Adjusted standard errors and an adjusted loglikelihood are provided, using the chandwich package &lt;https://cran.r-project.org/package=chandwich&gt; and the object-oriented features of the sandwich package &lt;https://cran.r-project.org/package=sandwich&gt;. The adjustment is based on a robust sandwich estimator of the parameter covariance matrix, based on the methodology in Chandler and Bate (2007) &lt;doi:10.1093/biomet/asm015&gt;. This can be used for cluster correlated data when interest lies in the parameters of the marginal distributions, or for performing inferences that are robust to certain types of model misspecification. Univariate extreme value models, including regression models, are supported.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">lax</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.2.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/lax-vignette.html">An overview of lax</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/paulnorthrop/lax/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="lax-">lax <a href="https://paulnorthrop.github.io/lax/" class="external-link"><img src="reference/figures/lax_logo.png" align="right" style="float:right; height:150px;" alt="lax logo"></a>
<a class="anchor" aria-label="anchor" href="#lax-"></a>
</h1></div>
<p><a href="https://github.com/paulnorthrop/lax/actions/workflows/R-CMD-check.yaml"><img src="https://github.com/paulnorthrop/lax/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a> <a href="https://app.codecov.io/github/paulnorthrop/lax?branch=master" class="external-link"><img src="https://codecov.io/github/paulnorthrop/lax/coverage.svg?branch=master" alt="Coverage Status"></a> <a href="https://cran.r-project.org/package=lax" class="external-link"><img src="https://www.r-pkg.org/badges/version/lax" alt="CRAN_Status_Badge"></a> <a href="https://cran.r-project.org/package=lax" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/lax?color=brightgreen" alt="Downloads (monthly)"></a> <a href="https://cran.r-project.org/package=lax" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/lax?color=brightgreen" alt="Downloads (total)"></a></p>
<div class="section level2">
<h2 id="loglikelihood-adjustment-for-extreme-value-models">Loglikelihood Adjustment for Extreme Value Models<a class="anchor" aria-label="anchor" href="#loglikelihood-adjustment-for-extreme-value-models"></a>
</h2>
<div class="section level3">
<h3 id="what-does-lax-do">What does lax do?<a class="anchor" aria-label="anchor" href="#what-does-lax-do"></a>
</h3>
<p>The <a href="https://CRAN.R-project.org/view=ExtremeValue" class="external-link">CRAN Task View on Extreme Value Analysis</a> provides information about R packages that perform various extreme value analyses. The <em>lax</em> package supplements the univariate extreme value modelling, including regression modelling, provided by 9 of these packages, namely <a href="https://cran.r-project.org/package=eva" class="external-link">eva</a>, <a href="https://cran.r-project.org/package=evd" class="external-link">evd</a>, <a href="https://cran.r-project.org/package=evir" class="external-link">evir</a>, <a href="https://cran.r-project.org/package=extRemes" class="external-link">extRemes</a>, <a href="https://cran.r-project.org/package=fExtremes" class="external-link">fExtremes</a>, <a href="https://cran.r-project.org/package=ismev" class="external-link">ismev</a>, <a href="https://cran.r-project.org/package=mev" class="external-link">mev</a>, <a href="https://cran.r-project.org/package=POT" class="external-link">POT</a> and <a href="https://cran.r-project.org/package=texmex" class="external-link">texmex</a>. <em>lax</em> works in an object-oriented way, operating on R objects returned from functions in other packages that summarise the fit of an extreme value model. It uses the <a href="https://cran.r-project.org/package=chandwich" class="external-link">chandwich</a> package to provide robust sandwich estimation of parameter covariance matrix and loglikelihood adjustment for models fitted by maximum likelihood estimation. This is performed by an <code>alogLik</code> S3 method, illustrated by the following example.</p>
</div>
<div class="section level3">
<h3 id="an-example">An example<a class="anchor" aria-label="anchor" href="#an-example"></a>
</h3>
<p>This example is based on the analysis presented in Section 5.2 of <a href="https://doi.org/10.1093/biomet/asm015" class="external-link">Chandler and Bate (2007)</a>. The data, which are available in the data frame <code>ow</code>, are a bivariate time series of annual maximum temperatures, recorded in degrees Fahrenheit, at Oxford and Worthing in England, for the period 1901 to 1980. If interest is only in the marginal distributions of high temperatures in Oxford and Worthing, then we might fit a GEV regression model in which some or all of the parameters may vary between Oxford and Worthing. However, we should adjust for the cluster dependence between temperatures recorded during the same year.</p>
<p>The following code fits such a model using the <code>fevd</code> function in the <a href="https://cran.r-project.org/package=extRemes" class="external-link">extRemes</a> package and the uses <code>alogLik</code> to perform adjusted inferences.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://paulnorthrop.github.io/lax/" class="external-link">lax</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">extRemes</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'extRemes'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     qqnorm, qqplot</span></span>
<span><span class="co"># Fit a GEV model with separate location, scale and shape for Oxford and Worthing</span></span>
<span><span class="co"># Note: phi = log(scale)</span></span>
<span><span class="va">evm_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/extRemes/man/fevd.html" class="external-link">fevd</a></span><span class="op">(</span><span class="va">temp</span>, <span class="va">ow</span>, location.fun <span class="op">=</span> <span class="op">~</span> <span class="va">loc</span>, scale.fun <span class="op">=</span> <span class="op">~</span> <span class="va">loc</span>, </span>
<span>                shape.fun <span class="op">=</span> <span class="op">~</span> <span class="va">loc</span><span class="op">)</span></span>
<span><span class="co"># Adjust the loglikelihood and standard errors</span></span>
<span><span class="va">adj_evm_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/alogLik.html">alogLik</a></span><span class="op">(</span><span class="va">evm_fit</span>, cluster <span class="op">=</span> <span class="va">ow</span><span class="op">$</span><span class="va">year</span>, cadjust <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># MLEs, SEs and adjusted SEs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">adj_evm_fit</span><span class="op">)</span></span>
<span><span class="co">#&gt;             MLE      SE adj. SE</span></span>
<span><span class="co">#&gt; mu0    81.17000 0.32820 0.40360</span></span>
<span><span class="co">#&gt; mu1     2.66800 0.32820 0.21280</span></span>
<span><span class="co">#&gt; sigma0  3.72900 0.22930 0.24260</span></span>
<span><span class="co">#&gt; sigma1  0.53090 0.22930 0.19110</span></span>
<span><span class="co">#&gt; xi0    -0.19890 0.04938 0.03944</span></span>
<span><span class="co">#&gt; xi1    -0.08828 0.04938 0.03625</span></span></code></pre></div>
<p>An object returned from <code>aloglik</code> is a function to evaluate the adjusted loglikelihood, with <code>anova</code>, <code>coef</code>, <code>confint</code>, <code>logLik</code>, <code>nobs</code>, <code>plot</code>, <code>print</code>, <code>summary</code> and <code>vcov</code> methods.</p>
</div>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>To get the current released version from CRAN:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"lax"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="vignette">Vignette<a class="anchor" aria-label="anchor" href="#vignette"></a>
</h3>
<p>See <code><a href="articles/lax-vignette.html">vignette("lax-vignette", package = "lax")</a></code> for an overview of the package.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=lax" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/paulnorthrop/lax/">Browse source code</a></li>
<li><a href="https://github.com/paulnorthrop/lax/issues">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 2)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing lax</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Paul J. Northrop <br><small class="roles"> Author, maintainer, copyright holder </small>   </li>
<li>Camellia Yin <br><small class="roles"> Author, copyright holder </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul J. Northrop, Camellia Yin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
